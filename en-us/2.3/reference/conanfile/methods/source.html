<!DOCTYPE html>
<html class="writer-html5" lang="en-US" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>source() &mdash; conan 2.3.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/reference/conanfile/methods/source.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5f30fb00"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="system_requirements()" href="system_requirements.html" />
    <link rel="prev" title="set_version()" href="set_version.html" />


 



</script>
<script type="text/javascript" src="../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whatsnew.html">What’s new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devops.html">Devops guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../reference.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../commands.html">Commands</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../conanfile.html">conanfile.py</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../attributes.html">Attributes</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../methods.html">Methods</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="build.html">build()</a></li>
<li class="toctree-l4"><a class="reference internal" href="build_id.html">build_id()</a></li>
<li class="toctree-l4"><a class="reference internal" href="build_requirements.html">build_requirements()</a></li>
<li class="toctree-l4"><a class="reference internal" href="compatibility.html">compatibility()</a></li>
<li class="toctree-l4"><a class="reference internal" href="configure.html">configure()</a></li>
<li class="toctree-l4"><a class="reference internal" href="config_options.html">config_options()</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploy.html">deploy()</a></li>
<li class="toctree-l4"><a class="reference internal" href="export.html">export()</a></li>
<li class="toctree-l4"><a class="reference internal" href="export_sources.html">export_sources()</a></li>
<li class="toctree-l4"><a class="reference internal" href="generate.html">generate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="init.html">init()</a></li>
<li class="toctree-l4"><a class="reference internal" href="layout.html">layout()</a></li>
<li class="toctree-l4"><a class="reference internal" href="package.html">package()</a></li>
<li class="toctree-l4"><a class="reference internal" href="package_id.html">package_id()</a></li>
<li class="toctree-l4"><a class="reference internal" href="package_info.html">package_info()</a></li>
<li class="toctree-l4"><a class="reference internal" href="requirements.html">requirements()</a></li>
<li class="toctree-l4"><a class="reference internal" href="requirements.html#package-type-trait-inferring">package_type trait inferring</a></li>
<li class="toctree-l4"><a class="reference internal" href="requirements.html#default-traits-for-each-kind-of-requires">Default traits for each kind of requires</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_name.html">set_name()</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_version.html">set_version()</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">source()</a></li>
<li class="toctree-l4"><a class="reference internal" href="system_requirements.html">system_requirements()</a></li>
<li class="toctree-l4"><a class="reference internal" href="test.html">test()</a></li>
<li class="toctree-l4"><a class="reference internal" href="validate.html">validate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="validate_build.html">validate_build()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../running_and_output.html">Running and output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile_txt.html">conanfile.txt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools.html">Recipe tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config_files.html">Configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions.html">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../environment.html">Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../binary_model.html">The binary model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conan_server.html">Conan Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../runners.html">Runners</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../reference.html">Reference</a></li>
          <li class="breadcrumb-item"><a href="../../conanfile.html">conanfile.py</a></li>
          <li class="breadcrumb-item"><a href="../methods.html">Methods</a></li>
      <li class="breadcrumb-item active">source()</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/develop2/reference/conanfile/methods/source.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="source">
<span id="reference-conanfile-methods-source"></span><h1>source()<a class="headerlink" href="#source" title="Link to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">source()</span></code> method can be used to retrieve the necessary source code to build a package from source, and to apply patches to such source code if necessary. It will be called when a package is being built from source, like with <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">create</span></code> or <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span>&#160; <span class="pre">--build=pkg*</span></code>, but it will not be called if a package pre-compiled binary is being used. That means that the source code will not be downloaded if a pre-compiled binary exists.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">source()</span></code> method can implement different strategies for retrieving the source code:</p>
<ul class="simple">
<li><p>Fetching the source code for a third party library:</p>
<ul>
<li><p>Using a <code class="docutils literal notranslate"><span class="pre">Git(self).clone()</span></code> to clone a Git repository</p></li>
<li><p>Executing a <code class="docutils literal notranslate"><span class="pre">download()</span></code> + <code class="docutils literal notranslate"><span class="pre">unzip()</span></code> or a combined <code class="docutils literal notranslate"><span class="pre">get()</span></code> (internally does download + unzip) to download a tarball, tgz, or zip archive.</p></li>
</ul>
</li>
<li><p>Fetching the source code for itself, from its repository, whose coordinates have been captured in the <code class="docutils literal notranslate"><span class="pre">conandata.yml</span></code> file in the <code class="docutils literal notranslate"><span class="pre">export()</span></code> method. This is the strategy that would be used to manage the source code for packages in which the <code class="docutils literal notranslate"><span class="pre">conanfile.py</span></code> lives in the package itself, but that for some reason we don’t want to put the source code in the recipe (like not distributing our source code, but being able to distribute our package binaries).</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">source()</span></code> method executes in the <code class="docutils literal notranslate"><span class="pre">self.source_folder</span></code>, the current working directory will be equal to that folder (which value is derived from <code class="docutils literal notranslate"><span class="pre">layout()</span></code> method).</p>
<p>A <code class="docutils literal notranslate"><span class="pre">source()</span></code> implementation might use the convenient <code class="docutils literal notranslate"><span class="pre">get()</span></code> helper, or use its own mechanisms or other Conan helpers for the task, something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">conan</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">conan.tools.files</span><span class="w"> </span><span class="kn">import</span> <span class="n">download</span><span class="p">,</span> <span class="n">unzip</span><span class="p">,</span> <span class="n">check_sha1</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PocoConan</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;poco&quot;</span>
    <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;1.6.0&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">zip_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;poco-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">-release.zip&quot;</span>
        <span class="c1"># Immutable source .zip</span>
        <span class="n">download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;https://github.com/pocoproject/poco/archive/poco-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">-release.zip&quot;</span><span class="p">,</span> <span class="n">zip_name</span><span class="p">)</span>
        <span class="c1"># Recommended practice, always check hashes of downloaded files</span>
        <span class="n">check_sha1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zip_name</span><span class="p">,</span> <span class="s2">&quot;8d87812ce591ced8ce3a022beec1df1c8b2fac87&quot;</span><span class="p">)</span>
        <span class="n">unzip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zip_name</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;poco-poco-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">-release&quot;</span><span class="p">,</span> <span class="s2">&quot;poco&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">zip_name</span><span class="p">)</span>
</pre></div>
</div>
<p>Applying patches to downloaded sources can be done (and should be done) in the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method if those patches
apply to all possible configurations. As explained below, it is not possible to introduce conditionals in the
<code class="docutils literal notranslate"><span class="pre">source()</span></code> method. If the patches are in file form, those patches must be exported together with the recipe, so they can be used whenever a build from source is fired.</p>
<p>It is possible to apply patches with:</p>
<ul class="simple">
<li><p>Your own or <code class="docutils literal notranslate"><span class="pre">git</span></code> patches utilities</p></li>
<li><p>The Conan built-in <code class="docutils literal notranslate"><span class="pre">patch()</span></code> utility to explicitly apply patches one by one</p></li>
<li><p>Apply the <code class="docutils literal notranslate"><span class="pre">apply_conandata_patches()</span></code> Conan utility to automatically apply all patches defined in <code class="docutils literal notranslate"><span class="pre">conandata.yml</span></code> file following some conventions.</p></li>
</ul>
<section id="source-caching">
<span id="reference-conanfile-methods-source-caching"></span><h2>Source caching<a class="headerlink" href="#source-caching" title="Link to this heading">¶</a></h2>
<p>Once the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method has been called, its result will be cached and reused for any build from source, for any configuration. That means that the retrieval of sources from the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method should be completely independent of the configuration. It is not possible to implement conditionals on the <code class="docutils literal notranslate"><span class="pre">settings</span></code>, and in general, any attempt to apply any conditional logic to the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method is wrong.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">compiler</span> <span class="o">==</span> <span class="s2">&quot;gcc&quot;</span><span class="p">:</span>  <span class="c1"># ERROR, will raise</span>
        <span class="c1"># download some source</span>
</pre></div>
</div>
<p>Trying to bypass the Conan exception by using some other mechanism like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Might work, but NOT recommended, try to avoid as much as possible</span>
    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="c1"># download something</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># download something different</span>
</pre></div>
</div>
<p>Might apparently work if not doing any cross-build, and not recollecting sources in a different OS, but could be problematic otherwise.</p>
<p>To be completely safe, if different source code is necessary for different configurations, the recommended approach would be to retrieve that code conditionally in the <code class="docutils literal notranslate"><span class="pre">build()</span></code> method.</p>
</section>
<section id="forced-retrieval-of-sources">
<h2>Forced retrieval of sources<a class="headerlink" href="#forced-retrieval-of-sources" title="Link to this heading">¶</a></h2>
<p>When working with a recipe in a user folder, it is easy to call the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method and force the retrieval of the source code, that will be done in the same user folder, according to the <code class="docutils literal notranslate"><span class="pre">layout()</span></code> definition:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span><span class="nb">source</span><span class="w"> </span>.
</pre></div>
</div>
<p>Calling the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method and forcing the retrieval of source code in the cache, for all or some dependencies, even if they are not being built from sources, is possible with the <code class="docutils literal notranslate"><span class="pre">tools.build:download_source=True</span></code> configuration. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>graph<span class="w"> </span>info<span class="w"> </span>.<span class="w"> </span>-c<span class="w"> </span>tools.build:download_source<span class="o">=</span>True
</pre></div>
</div>
<p>Will compute the dependency graph, then call the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method for all “host” packages in the graph (as the configuration by default is a “host” configuration, if you want also the sources for the “build” context <code class="docutils literal notranslate"><span class="pre">tool_requires</span></code>, you could use <code class="docutils literal notranslate"><span class="pre">-c:b</span> <span class="pre">tools.build:download_source=True</span></code>). It is possible to collect all the source folders from the json formatted output, or to automate recollection of all sources, a <code class="docutils literal notranslate"><span class="pre">deployer</span></code> could be used.</p>
<p>Likewise, it is possible to retrieve the sources for packages in other <code class="docutils literal notranslate"><span class="pre">create</span></code> and <code class="docutils literal notranslate"><span class="pre">install</span></code> commands, just by passing the configuration. Finally, as also configuration can be defined per-package, using <code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">mypkg*:tools.build:download_source=True</span></code> would only retrieve the sources of packages matching the <code class="docutils literal notranslate"><span class="pre">mypkg*</span></code> pattern.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">tools.build:download_source=True</span></code> will not have any effect on packages in <strong>editable</strong> mode. Downloading sources in that case could easily overwrite and destroy local developer changes over that code. The <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">source</span></code> command must be used on packages in editable mode to download the sources.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Best practices</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">source()</span></code> method should be the same for all configurations, it cannot be conditional to any configuration.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">source()</span></code> method should retrieve immutable sources. Using some branch name, HEAD, or a tarball whose URL is not immutable and is being overwritten is a bad practice and will lead to broken packages. Using a Git commit, a frozen Git release tag, or a fixed and versioned release tarballs is the expected input.</p></li>
<li><p>Applying patches should be done by default in the <code class="docutils literal notranslate"><span class="pre">source()</span></code> method, except if the patches are exclusive for one configuration, in that case they could be applied in <code class="docutils literal notranslate"><span class="pre">build()</span></code> method.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">source()</span></code> method should not access nor manipulate files in other folders different to the <code class="docutils literal notranslate"><span class="pre">self.source_folder</span></code>. All the “exported” files are copied to the <code class="docutils literal notranslate"><span class="pre">self.source_folder</span></code> before calling it.</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="../../../tutorial/creating_packages/handle_sources_in_packages.html#creating-packages-handle-sources-in-packages"><span class="std std-ref">the tutorial about managing recipe sources</span></a> for more information.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="set_version.html" class="btn btn-neutral float-left" title="set_version()" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="system_requirements.html" class="btn btn-neutral float-right" title="system_requirements()" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">Last updated on Feb 17, 2026.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>