



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Upgrading to conan 1.0 &mdash; conan 1.5.2 文档</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  


  
    <link rel="stylesheet" href="_static/css/signup.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="索引"
              href="genindex.html"/>
        <link rel="search" title="搜索" href="search.html"/>
    <link rel="top" title="conan 1.5.2 文档" href="index.html"/>
        <link rel="next" title="Introduction" href="introduction.html"/>
        <link rel="prev" title="Welcome to conan" href="index.html"/>


 



</script>
<script type="text/javascript" src="ltd-provenance.js"></script>
<script type="text/javascript" src="ltd-current.js"></script>
<script type="text/javascript" src="../../ltd-config.js"></script>
<script type="text/javascript" src="../../ltd-flyout.js"></script>


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="https://conan.io">
          

          
            
            <img src="_static/conan_logo.png" class="logo" />
          
          </a>

            

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Upgrading to conan 1.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#command-line-changes">Command line changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deprecations-removals">Deprecations/removals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#settings-and-profiles-gcc-clang-versioning">Settings and profiles. GCC/CLang versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#new-features">New features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_packages.html">Using packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating_packages.html">Creating packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="uploading_packages.html">Uploading packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing_packages.html">Developing packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="devtools.html">Package apps and devtools</a></li>
<li class="toctree-l1"><a class="reference internal" href="mastering.html">Mastering conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="systems_cross_building.html">Systems and cross building</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtos.html">Howtos</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="videos.html">Videos and links</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
          <div class="dark_newsletter-div">
             <p>Sign up for release updates:</p>
              <script src="https://app-lon04.marketo.com/js/forms2/js/forms2.min.js"></script>
              <form id="mktoForm_1479"></form>
              <script>MktoForms2.loadForm("https://app-lon04.marketo.com", "256-FNZ-187", 1479);</script>
          </div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">conan</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Upgrading to conan 1.0</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/conan1.0.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="upgrading-to-conan-1-0">
<span id="conan-1-0"></span><h1>Upgrading to conan 1.0<a class="headerlink" href="#upgrading-to-conan-1-0" title="此标题的永久链接">¶</a></h1>
<p>This section summarizes the most important changes you need to consider when upgrading to Conan v1.0 from version 0.x. For a full list of changes and considerations, please refer to the <a class="reference internal" href="changelog.html#changelog"><span class="std std-ref">changelog</span></a>.</p>
<section id="command-line-changes">
<h2>Command line changes<a class="headerlink" href="#command-line-changes" title="此标题的永久链接">¶</a></h2>
<p>There are a few breaking changes (compared to v0.30), however, most of them are in command line arguments so they are quite easy to fix. The most significant change  is that now, instead of using <code class="docutils literal notranslate"><span class="pre">--path</span></code> <code class="docutils literal notranslate"><span class="pre">--file</span></code> arguments, most commands now require the path to the conanfile folder or file. Specifically, <strong class="command">conan install</strong>, <strong class="command">conan export</strong> and <strong class="command">conan create</strong> will be the ones most affected:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># instead of --path=myfolder --file=myconanfile.py, now you can do:</span>
$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>.<span class="w"> </span><span class="c1"># Note the &quot;.&quot; is now mandatory</span>
$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>folder/myconanfile.txt
$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>../myconanfile.py
$<span class="w"> </span>conan<span class="w"> </span>info<span class="w"> </span>.
$<span class="w"> </span>conan<span class="w"> </span>create<span class="w"> </span>.<span class="w"> </span>user/channel
$<span class="w"> </span>conan<span class="w"> </span>create<span class="w"> </span>.<span class="w"> </span>Pkg/0.1@user/channel
$<span class="w"> </span>conan<span class="w"> </span>create<span class="w"> </span>mypkgconanfile.py<span class="w"> </span>Pkg/0.1@user/channel
$<span class="w"> </span>conan<span class="w"> </span><span class="nb">export</span><span class="w"> </span>.<span class="w"> </span>user/channel
$<span class="w"> </span>conan<span class="w"> </span><span class="nb">export</span><span class="w"> </span>.<span class="w"> </span>Pkg/0.1@user/channel
$<span class="w"> </span>conan<span class="w"> </span><span class="nb">export</span><span class="w"> </span>myfolder/myconanfile.py<span class="w"> </span>Pkg/0.1@user/channel
</pre></div>
</div>
<p>This behavior aligns with the <strong class="command">conan source</strong>, <strong class="command">conan build</strong>, <strong class="command">conan package</strong> commands, that all use the same arguments to locate the <em>conanfile.py</em> file containing the logic to be run.</p>
<p>Now, all commands read: <strong class="command">command &lt;origin-conanfile&gt; ...</strong></p>
<p>In addition, all command line arguments now use a dash instead of an underscore:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>build<span class="w"> </span>..<span class="w"> </span>--source-folder<span class="o">=</span>../src<span class="w">  </span><span class="c1"># not --source_folder</span>
</pre></div>
</div>
</section>
<section id="deprecations-removals">
<h2>Deprecations/removals<a class="headerlink" href="#deprecations-removals" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>scopes were completely removed in conan 0.30.X</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.conanfile_directory</span></code> has been removed. Instead, use <code class="docutils literal notranslate"><span class="pre">self.source_folder</span></code>, <code class="docutils literal notranslate"><span class="pre">self.build_folder</span></code>, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">self.cpp_info</span></code>, <code class="docutils literal notranslate"><span class="pre">self.env_info</span></code> and <code class="docutils literal notranslate"><span class="pre">self.user_info</span></code> scope are now only included the <code class="docutils literal notranslate"><span class="pre">package_info()</span></code> method</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcc</span></code> and <code class="docutils literal notranslate"><span class="pre">ConfigureEnvironment</span></code> were removed in conan 0.30.1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">werror</span></code> doesn’t exist anymore. It is now built-in behavior.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">test_package</span></code> command has been removed. Instead, use <strong class="command">conan create</strong> and <strong class="command">conan test</strong>.</p></li>
<li><p>From Conan v0.29, the``CMake`` helper only supports the <code class="docutils literal notranslate"><span class="pre">CMake(self)</span></code> syntax</p></li>
<li><p>In Conan v0.28, the <strong class="command">conan package_files</strong> command was replaced by the <strong class="command">conan export-pkg</strong> command.</p></li>
</ul>
</section>
<section id="settings-and-profiles-gcc-clang-versioning">
<h2>Settings and profiles. GCC/CLang versioning<a class="headerlink" href="#settings-and-profiles-gcc-clang-versioning" title="此标题的永久链接">¶</a></h2>
<p>The GCC and Clang compilers have modified their versioning approach. From GCC version 5 and above and Clang version 4 and above, minor versions are really bug fixes, and then, they have binary compatibility. To adapt to this, Conan now includes a major version in the <em>settings.yml</em> default settings file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">gcc</span><span class="p">:</span>
<span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;4.1&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;4.4&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;4.5&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;4.6&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;4.7&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;4.8&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;4.9&quot;</span><span class="p p-Indicator">,</span>
<span class="w">              </span><span class="s">&quot;5&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;5.1&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;5.2&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;5.3&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;5.4&quot;</span><span class="p p-Indicator">,</span>
<span class="w">              </span><span class="s">&quot;6&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;6.1&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;6.2&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;6.3&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;6.4&quot;</span><span class="p p-Indicator">,</span>
<span class="w">              </span><span class="s">&quot;7&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;7.1&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;7.2&quot;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>Most package creators want to use the major-only settings, like <code class="docutils literal notranslate"><span class="pre">-s</span> <span class="pre">compiler=gcc</span> <span class="pre">-s</span> <span class="pre">compiler.version=5</span></code>,
instead of specifying the minors too.</p>
<p>The default profile detection and creation has been modified accordingly, however, if you have a default profile you may want to update it to reflect this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[settings]
os=Linux
compiler=gcc
compiler.version=7 #instead of 7.2
</pre></div>
</div>
<p>Conan associated tools (conan-package-tools, conan.cmake) have been upgraded to accomodate these new defaults.</p>
</section>
<section id="new-features">
<h2>New features<a class="headerlink" href="#new-features" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>Cross-compilation support with new default settings in <em>settings.yml</em>: <code class="docutils literal notranslate"><span class="pre">os_build</span></code>, <code class="docutils literal notranslate"><span class="pre">arch_build</span></code>, <code class="docutils literal notranslate"><span class="pre">os_target</span></code>, <code class="docutils literal notranslate"><span class="pre">arch_target</span></code>.
These are automatically removed from the <code class="docutils literal notranslate"><span class="pre">package_id</span></code> computation, or kept if they are the only ones defined (as usually happens with dev-tools packages). You can also keep them with the <code class="docutils literal notranslate"><span class="pre">self.info.include_build_settings()</span></code> method (call it in your <code class="docutils literal notranslate"><span class="pre">package_id()</span></code> method).</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p><strong>Do not</strong> use cross-build settings <code class="docutils literal notranslate"><span class="pre">os_build</span></code> and <code class="docutils literal notranslate"><span class="pre">arch_build</span></code> for standard packages and libraries.
They are only useful for packages that are used via <code class="docutils literal notranslate"><span class="pre">build_requires</span></code>, like <code class="docutils literal notranslate"><span class="pre">cmake_installer</span></code> or <code class="docutils literal notranslate"><span class="pre">mingw_installer</span></code>.</p>
</div>
<ul class="simple">
<li><p>Model and utilities for Windows subsystems</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>os:
<span class="w">    </span>Windows:
<span class="w">        </span>subsystem:<span class="w"> </span><span class="o">[</span>None,<span class="w"> </span>cygwin,<span class="w"> </span>msys,<span class="w"> </span>msys2,<span class="w"> </span>wsl<span class="o">]</span>
</pre></div>
</div>
<p>This subsetting can be used by build helpers such as <code class="docutils literal notranslate"><span class="pre">CMake</span></code> to act accordingly.</p>
</section>
</section>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="introduction.html" class="btn btn-neutral float-right" title="Introduction" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to conan" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, JFrog.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.5.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/documentation_options.js"></script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  


 


</body>
</html>