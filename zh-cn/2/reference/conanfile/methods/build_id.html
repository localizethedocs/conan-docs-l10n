<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>build_id() &mdash; conan 2.21.0 文档</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/reference/conanfile/methods/build_id.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=67fa3b76"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/translations.js?v=beaddf03"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" />
    <link rel="next" title="build_requirements()" href="build_requirements.html" />
    <link rel="prev" title="build()" href="build.html" />


 



</script>
<script type="text/javascript" src="../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ci_tutorial/tutorial.html">CI 教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devops/devops.html">Devops guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../reference.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../commands.html">Commands</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../conanfile.html">conanfile.py</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../attributes.html">Attributes</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../methods.html">Methods</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="build.html">build()</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">build_id()</a></li>
<li class="toctree-l4"><a class="reference internal" href="build_requirements.html">build_requirements()</a></li>
<li class="toctree-l4"><a class="reference internal" href="compatibility.html">compatibility()</a></li>
<li class="toctree-l4"><a class="reference internal" href="configure.html">configure()</a></li>
<li class="toctree-l4"><a class="reference internal" href="config_options.html">config_options()</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploy.html">deploy()</a></li>
<li class="toctree-l4"><a class="reference internal" href="export.html">export()</a></li>
<li class="toctree-l4"><a class="reference internal" href="export_sources.html">export_sources()</a></li>
<li class="toctree-l4"><a class="reference internal" href="finalize.html">finalize()</a></li>
<li class="toctree-l4"><a class="reference internal" href="generate.html">generate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="init.html">init()</a></li>
<li class="toctree-l4"><a class="reference internal" href="layout.html">layout()</a></li>
<li class="toctree-l4"><a class="reference internal" href="package.html">package()</a></li>
<li class="toctree-l4"><a class="reference internal" href="package_id.html">package_id()</a></li>
<li class="toctree-l4"><a class="reference internal" href="package_info.html">package_info()</a></li>
<li class="toctree-l4"><a class="reference internal" href="requirements.html">requirements()</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_name.html">set_name()</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_version.html">set_version()</a></li>
<li class="toctree-l4"><a class="reference internal" href="source.html">source()</a></li>
<li class="toctree-l4"><a class="reference internal" href="system_requirements.html">system_requirements()</a></li>
<li class="toctree-l4"><a class="reference internal" href="test.html">test()</a></li>
<li class="toctree-l4"><a class="reference internal" href="validate.html">validate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="validate_build.html">validate_build()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../running_and_output.html">Running and output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile_txt.html">conanfile.txt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workspace_files.html">Workspace files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools.html">Recipe tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config_files.html">Configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions.html">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../environment.html">Environment variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../binary_model.html">The binary model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conan_server.html">Conan Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../runners.html">Runners</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../incubating.html">Incubating features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whatsnew.html">What’s new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../reference.html">Reference</a></li>
          <li class="breadcrumb-item"><a href="../../conanfile.html">conanfile.py</a></li>
          <li class="breadcrumb-item"><a href="../methods.html">Methods</a></li>
      <li class="breadcrumb-item active">build_id()</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/develop2/reference/conanfile/methods/build_id.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="build-id">
<span id="reference-conanfile-methods-build-id"></span><h1>build_id()<a class="headerlink" href="#build-id" title="Link to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">build_id()</span></code> method allows you to <strong>reuse a single build</strong> to create multiple binary packages in the Conan cache,
saving time by avoiding unnecessary rebuilds.</p>
<p>It is primarily an optimization tool for situations where <strong>building each configuration separately isn’t feasible</strong>.</p>
<p>There are a couple of scenarios where this could be useful, for example, when a package build:</p>
<ul class="simple">
<li><p><strong>Generates multiple configurations in a single build run</strong>:
Some build scripts always produce both Debug and Release artifacts together, without a way to build them separately.</p></li>
<li><p><strong>Produces one configuration but different sets of artifacts</strong>:
The build could generate the main library plus some test executables, and you want to create:</p>
<ul>
<li><p>one package with just the library (for general use), and</p></li>
<li><p>another package that includes both the library and the test binaries (for compliance, debugging, or reproducibility).</p></li>
</ul>
</li>
</ul>
<p>In these scenarios, <strong>reusing the same build folder avoids recompiling the same sources multiple times</strong> just because you need slightly different packaging.</p>
<section id="how-does-the-build-folder-relate-to-the-package-id-and-the-build-id">
<h2>How does the build folder relate to the package ID and the build ID?<a class="headerlink" href="#how-does-the-build-folder-relate-to-the-package-id-and-the-build-id" title="Link to this heading">¶</a></h2>
<p>By default, Conan creates <strong>one build folder per unique package ID</strong>, where:</p>
<ul class="simple">
<li><p>Generally, the <strong>package ID</strong> depends on the combination of <cite>settings</cite>, <cite>options</cite>, and dependencies.</p></li>
<li><p>Each different <strong>package ID</strong> triggers a separate <code class="docutils literal notranslate"><span class="pre">build()</span></code> execution and generates a separate build folder.</p></li>
</ul>
<p>When you define the <code class="docutils literal notranslate"><span class="pre">build_id()</span></code> method, you can <strong>force different package IDs to share the same build folder</strong> by customizing <cite>self.info_build</cite>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self.info_build</span></code> is like <code class="docutils literal notranslate"><span class="pre">self.info</span></code>, but it only affects the computation of the <strong>build ID</strong>, not the final package ID.</p></li>
<li><p>Any package IDs with the same build ID will reuse the same build folder and the same build step.</p></li>
</ul>
<section id="example-sharing-the-build-for-debug-and-release">
<h3>Example: sharing the build for Debug and Release<a class="headerlink" href="#example-sharing-the-build-for-debug-and-release" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">build_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info_build</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">build_type</span> <span class="o">=</span> <span class="s2">&quot;Any&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>With this recipe, Debug and Release will each produce their own package IDs (and thus their own binary packages),
but they will <strong>share the same build folder</strong>, because the build ID ignores the <code class="docutils literal notranslate"><span class="pre">build_type</span></code> setting.</p></li>
<li><p><strong>However, you still need to run one</strong> <strong class="command">conan create</strong> <strong>command per configuration</strong> (e.g., once for Debug, once for Release).
Conan will check if the build folder already exists (based on the shared build ID) and skip the actual compilation
if it’s already been built, only executing <cite>package()</cite> to create the corresponding package.</p></li>
</ul>
<p>Example workflow:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># First build: creates the build folder + packages the Debug package</span>
$<span class="w"> </span>conan<span class="w"> </span>create<span class="w"> </span>.<span class="w"> </span>-s<span class="w"> </span><span class="nv">build_type</span><span class="o">=</span>Debug

<span class="c1"># Second build: reuses the previous build folder + packages the Release package without rebuilding</span>
$<span class="w"> </span>conan<span class="w"> </span>create<span class="w"> </span>.<span class="w"> </span>-s<span class="w"> </span><span class="nv">build_type</span><span class="o">=</span>Release
</pre></div>
</div>
<p>This way, although we called <strong class="command">conan create</strong> twice (once per package ID), the actual build will only happen once.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>You can also customize <code class="docutils literal notranslate"><span class="pre">build_id()</span></code> based on options:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info_build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">myoption</span> <span class="o">=</span> <span class="s2">&quot;MyValue&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info_build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">fullsource</span> <span class="o">=</span> <span class="s2">&quot;Always&quot;</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="conditional-usage-of-the-build-id">
<h2>Conditional usage of the build ID<a class="headerlink" href="#conditional-usage-of-the-build-id" title="Link to this heading">¶</a></h2>
<p>If the <code class="docutils literal notranslate"><span class="pre">build_id()</span></code> method does not modify the <code class="docutils literal notranslate"><span class="pre">self.info_build</span></code> data, and produces the same build ID as the package ID,
then the standard behavior will be applied. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">build_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">os</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_build</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">build_type</span> <span class="o">=</span> <span class="s2">&quot;Any&quot;</span>
</pre></div>
</div>
<p>This will only produce a different <strong>build ID</strong> if the package is for Windows, so it will only run the <code class="docutils literal notranslate"><span class="pre">build()</span></code> method once
for all the <code class="docutils literal notranslate"><span class="pre">build_type</span></code> values.</p>
<p>For any other OS, Conan will behave as usual (as if the <code class="docutils literal notranslate"><span class="pre">build_id()</span></code> method was not defined), running the <code class="docutils literal notranslate"><span class="pre">build()</span></code> method
for every <code class="docutils literal notranslate"><span class="pre">build_type</span></code> configuration.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Best practices</strong></p>
<p>The goal of the <code class="docutils literal notranslate"><span class="pre">build_id()</span></code> method is to deal with legacy build scripts that cannot easily be changed
to compile one configuration at a time. We strongly recommend to just package <strong>one package binary per package ID</strong>
for each different configuration.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="build.html" class="btn btn-neutral float-left" title="build()" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="build_requirements.html" class="btn btn-neutral float-right" title="build_requirements()" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">最后更新于 10月 28, 2025.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>