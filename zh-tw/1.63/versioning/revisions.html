<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Package Revisions &mdash; conan 1.63.0 說明文件</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/css/conan.css?v=2e89a5c2" />

  
    <link rel="shortcut icon" href="../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/versioning/revisions.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=348821e1"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=d9a6981e"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="next" title="Lockfiles" href="lockfiles.html" />
    <link rel="prev" title="Version ranges" href="version_ranges.html" />


 



</script>
<script type="text/javascript" src="../ltd-provenance.js"></script>
<script type="text/javascript" src="../ltd-current.js"></script>
<script type="text/javascript" src="../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/conan-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.63
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">介紹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conan_v2.html">Conan migration guide to 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training_courses.html">Training Courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_packages.html">使用軟體包</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creating_packages.html">Creating Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uploading_packages.html">上傳軟體包</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing_packages.html">Developing packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devtools.html">Package apps and devtools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../versioning.html">Versioning</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction to versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_ranges.html">Version ranges</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Package Revisions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-it-works">How it works</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-activate-the-revisions">How to activate the revisions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#git-and-line-endings-on-windows">GIT and Line Endings on Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-support">Server support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lockfiles.html">Lockfiles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../mastering.html">精通 Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../systems_cross_building.html">Systems and cross building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending.html">Extending Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtos.html">Howtos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheatsheet.html">Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos.html">Videos and links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">變更日誌</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
            <div class="admonition warning wy-text-center" style="position:sticky;top:0;border: 1px solid orange">
              <p>This document is for a <b>"1.X" legacy</b> Conan version. <a href="https://docs.conan.io/2/">Click here to read the <b>Conan 2.0</b> documentation</a></p>
            </div>
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../versioning.html">Versioning</a></li>
      <li class="breadcrumb-item active">Package Revisions</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/master/versioning/revisions.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="package-revisions">
<span id="id1"></span><h1>Package Revisions<a class="headerlink" href="#package-revisions" title="Link to this heading"></a></h1>
<p>The goal of the revisions feature is to achieve package immutability, the packages in a server are never overwritten.</p>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p>Revisions achieve immutability. For achieving reproducible builds and reproducible dependencies, <strong>lockfiles</strong>
are used. Lockfiles can capture an exact state of a dependency graph, down to exact versions and revisions, and use
it later to force their usage, even if new versions or revisions were uploaded to the servers.</p>
<p>Learn more about <a class="reference internal" href="lockfiles.html#versioning-lockfiles"><span class="std std-ref">lockfiles here.</span></a></p>
</div>
<section id="how-it-works">
<h2>How it works<a class="headerlink" href="#how-it-works" title="Link to this heading"></a></h2>
<p><strong>In the client</strong></p>
<ul>
<li><p>When a <strong>recipe</strong> is exported, Conan calculates a unique ID (revision). For every change,
a new recipe revision (RREV) will be calculated. By default it will use the checksum hash of the
recipe manifest.</p>
<p>Nevertheless, the recipe creator can explicitly declare the <a class="reference internal" href="../reference/conanfile/attributes.html#revision-mode-attribute"><span class="std std-ref">revision mode</span></a>,
it can be either <code class="docutils literal notranslate"><span class="pre">scm</span></code> (uses version control system or raises) or <code class="docutils literal notranslate"><span class="pre">hash</span></code> (use manifest hash).</p>
</li>
<li><p>When a <strong>package</strong> is created (by running <a class="reference internal" href="../reference/commands/creator/create.html#conan-create"><span class="std std-ref">conan create</span></a> or <a class="reference internal" href="../reference/commands/creator/export-pkg.html#conan-export-pkg"><span class="std std-ref">conan export-pkg</span></a>)
a new package revision (PREV) will be calculated always using the hash of the package contents.
The packages and their revisions (PREVs) belongs to a concrete recipe revision (RREV).
The same package ID (for example for Linux/GCC5/Debug), can have multiple revisions (PREVs) that belong
to a concrete RREV.</p></li>
</ul>
<p>If a client requests a reference like <code class="docutils literal notranslate"><span class="pre">lib/1.0&#64;conan/stable</span></code>, Conan will automatically retrieve the latest revision in case
the local cache doesn’t contain any revisions already. If a client needs to update an existing revision, they have to ask for updates explicitly
with <code class="docutils literal notranslate"><span class="pre">-u,</span> <span class="pre">--update</span></code> argument to <strong class="command">conan install</strong> command. In the client cache there is
<strong>only one revision installed simultaneously</strong>.</p>
<p>The revisions can be pinned when you write a reference (in the recipe requires, a reference in a
<strong class="command">conan install</strong> command,…) but if you don’t specify a revision, the server will retrieve the latest revision.</p>
<p>If you specify a pinned revision in your references, and that revision is not the one present in the Conan cache, and <code class="docutils literal notranslate"><span class="pre">--update</span></code>
is not provided, it will fail with an error. This behavior can be change with <code class="docutils literal notranslate"><span class="pre">core:allow_explicit_revision_update=True</span></code>
<code class="docutils literal notranslate"><span class="pre">[conf]</span></code> configuration. It can result in later errors (that won’t be possible to fix, use it at your own risk),
for example as the cache can only host 1 revision, it might happen that multiple pinned references are competing for it, and kicking
each others revisions out of the cache while the dependency graph is computed.</p>
<p>You can specify the references in the following formats:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Reference</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lib/1.0&#64;conan/stable</span></code></p></td>
<td><p>Latest RREV for <code class="docutils literal notranslate"><span class="pre">lib/1.0&#64;conan/stable</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lib/1.0&#64;conan/stable#RREV</span></code></p></td>
<td><p>Specific RREV for <code class="docutils literal notranslate"><span class="pre">lib/1.0&#64;conan/stable</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lib/1.0&#64;conan/stable#RREV:PACKAGE_ID</span></code></p></td>
<td><p>A binary package belonging to the specific RREV</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lib/1.0&#64;conan/stable#RREV:PACKAGE_ID#PREV</span></code></p></td>
<td><p>A binary package revision PREV belonging to the specific RREV</p></td>
</tr>
</tbody>
</table>
<p><strong>In the server</strong></p>
<p>By using a new folder layout and protocol it is able to store multiple revisions, both for recipes and binary packages.</p>
</section>
<section id="how-to-activate-the-revisions">
<h2>How to activate the revisions<a class="headerlink" href="#how-to-activate-the-revisions" title="Link to this heading"></a></h2>
<p>You have to explicitly activate the feature by either:</p>
<blockquote>
<div><ul class="simple">
<li><p>Adding <code class="docutils literal notranslate"><span class="pre">revisions_enabled=1</span></code> in the <code class="docutils literal notranslate"><span class="pre">[general]</span></code> section of your <em>conan.conf</em> file (preferred)</p></li>
<li><p>Setting the <code class="docutils literal notranslate"><span class="pre">CONAN_REVISIONS_ENABLED=1</span></code> environment variable.</p></li>
</ul>
</div></blockquote>
<p>Take into account that it changes the default Conan behavior. e.g:</p>
<blockquote>
<div><ul class="simple">
<li><p>A client with revisions enabled will only find binary packages that belong to the installed recipe revision.
For example, If you create a recipe and run <strong class="command">conan create . user/channel</strong> and then you modify the recipe and
export it (<strong class="command">conan export . user/channel</strong>), the binary package generated in the <strong class="command">conan create</strong> command
doesn’t belong to the new exported recipe. So it won’t be located unless the previous recipe is recovered.</p></li>
<li><p>If you generate and upload N binary packages for a recipe with a given revision, then if you modify the recipe, and thus the recipe
revision, you need to build and upload N new binaries matching that new recipe revision.</p></li>
</ul>
</div></blockquote>
</section>
<section id="git-and-line-endings-on-windows">
<h2>GIT and Line Endings on Windows<a class="headerlink" href="#git-and-line-endings-on-windows" title="Link to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p><strong>Problem</strong></p>
<p>Git will (by default) checkout files in Windows systems using CRLF line endings, effectively producing different files. As files are different, the Conan revisions will be different from the revisions computed in other platforms such as Linux, resulting in missing the respective binaries in the other revision.</p>
</div>
<p><strong>Solution</strong></p>
<p>It is necessary to instruct Git to do the checkout with the same line endings. This can be done several ways, for example, by adding a .gitattributes file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[auto]</span>
<span class="w">  </span><span class="na">crlf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>
</pre></div>
</div>
</section>
<section id="server-support">
<h2>Server support<a class="headerlink" href="#server-support" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">conan_server</span></code> &gt;= 1.13.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Artifactory</span></code> &gt;= 6.9.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ConanCenter</span></code>.</p></li>
</ul>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="version_ranges.html" class="btn btn-neutral float-left" title="Version ranges" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lockfiles.html" class="btn btn-neutral float-right" title="Lockfiles" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">最後更新於 2月 16, 2026。
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>