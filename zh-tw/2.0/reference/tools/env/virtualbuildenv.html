<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VirtualBuildEnv &mdash; conan 2.0.17 說明文件</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/reference/tools/env/virtualbuildenv.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=8c397be9"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/translations.js?v=d9a6981e"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜尋" href="../../../search.html" />
    <link rel="next" title="VirtualRunEnv" href="virtualrunenv.html" />
    <link rel="prev" title="EnvVars" href="envvars.html" />


 



</script>
<script type="text/javascript" src="../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">介紹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whatsnew.html">What’s new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">教學</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devops.html">開發運維指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">範例</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../reference.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../commands.html">命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile.html">conanfile.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile_txt.html">conanfile.txt</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tools.html">Recipe tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../android.html">conan.tools.android</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apple.html">conan.tools.apple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build.html">conan.tools.build</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cmake.html">conan.tools.cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp_info.html">conan.tools.CppInfo</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../env.html">conan.tools.env</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="environment.html">Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="envvars.html">EnvVars</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">VirtualBuildEnv</a></li>
<li class="toctree-l4"><a class="reference internal" href="virtualrunenv.html">VirtualRunEnv</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../files.html">conan.tools.files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gnu.html">conan.tools.gnu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../google.html">conan.tools.google</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intel.html">conan.tools.intel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../layout.html">conan.tools.layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../meson.html">conan.tools.meson</a></li>
<li class="toctree-l3"><a class="reference internal" href="../microsoft.html">conan.tools.microsoft</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scm.html">conan.tools.scm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scons.html">conan.tools.scons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../system.html">conan.tools.system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../config_files.html">組態檔</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions.html">擴充功能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../environment.html">環境變數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../binary_model.html">The binary model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conan_server.html">Conan Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">變更日誌</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../reference.html">Reference</a></li>
          <li class="breadcrumb-item"><a href="../../tools.html">Recipe tools</a></li>
          <li class="breadcrumb-item"><a href="../env.html">conan.tools.env</a></li>
      <li class="breadcrumb-item active">VirtualBuildEnv</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/develop2/reference/tools/env/virtualbuildenv.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="virtualbuildenv">
<span id="conan-tools-env-virtualbuildenv"></span><h1>VirtualBuildEnv<a class="headerlink" href="#virtualbuildenv" title="Link to this heading">¶</a></h1>
<p>VirtualBuildEnv is a generator that produces a <em>conanbuildenv</em> .bat, .ps1 or .sh script containing the environment variables
of the build time context:</p>
<blockquote>
<div><ul class="simple">
<li><p>From the <code class="docutils literal notranslate"><span class="pre">self.buildenv_info</span></code> of the direct <code class="docutils literal notranslate"><span class="pre">tool_requires</span></code> in 「build」 context.</p></li>
<li><p>From the <code class="docutils literal notranslate"><span class="pre">self.runenv_info</span></code> of the transitive dependencies of those <code class="docutils literal notranslate"><span class="pre">tool_requires</span></code>.</p></li>
</ul>
</div></blockquote>
<p>It can be used by name in conanfiles:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">conanfile.py</span><a class="headerlink" href="#id1" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Pkg</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;VirtualBuildEnv&quot;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">conanfile.txt</span><a class="headerlink" href="#id2" title="Link to this code">¶</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[generators]
VirtualBuildEnv
</pre></div>
</div>
</div>
<p>And it can also be fully instantiated in the conanfile <code class="docutils literal notranslate"><span class="pre">generate()</span></code> method:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">conanfile.py</span><a class="headerlink" href="#id3" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">conan</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">conan.tools.env</span><span class="w"> </span><span class="kn">import</span> <span class="n">VirtualBuildEnv</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Pkg</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>
    <span class="n">requires</span> <span class="o">=</span> <span class="s2">&quot;zlib/1.2.11&quot;</span><span class="p">,</span> <span class="s2">&quot;bzip2/1.0.8&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ms</span> <span class="o">=</span> <span class="n">VirtualBuildEnv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ms</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<section id="generated-files">
<h2>生成的文件<a class="headerlink" href="#generated-files" title="Link to this heading">¶</a></h2>
<p>This generator (for example the invocation of <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span> <span class="pre">--tool-require=cmake/3.20.0&#64;</span> <span class="pre">-g</span> <span class="pre">VirtualBuildEnv</span></code>)
will create the following files:</p>
<ul class="simple">
<li><p>conanbuildenv-release-x86_64.(bat|ps1|sh): This file contains the actual definition of environment variables
like PATH, LD_LIBRARY_PATH, etc, and any other variable defined in the dependencies <code class="docutils literal notranslate"><span class="pre">buildenv_info</span></code>
corresponding to the <code class="docutils literal notranslate"><span class="pre">build</span></code> context, and to the current installed
configuration. If a repeated call is done with other settings, a different file will be created.
After the execution or sourcing of this file, a new deactivation script will be generated, capturing the current
environment, so the environment can be restored when desired. The file will be named also following the
current active configuration, like <code class="docutils literal notranslate"><span class="pre">deactivate_conanbuildenv-release-x86_64.bat</span></code>.</p></li>
<li><p>conanbuild.(bat|ps1|sh): Accumulates the calls to one or more other scripts, in case there are multiple tools
in the generate process that create files, to give one single convenient file for all. This only calls
the latest specific configuration one, that is, if <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> is called first for Release build type,
and then for Debug, <code class="docutils literal notranslate"><span class="pre">conanbuild.(bat|ps1|sh)</span></code> script will call the Debug one.</p></li>
<li><p>deactivate_conanbuild.(bat|ps1|sh): Accumulates the deactivation calls defined in the above <code class="docutils literal notranslate"><span class="pre">conanbuild.(bat|ps1|sh)</span></code>.
This file should only be called after the accumulated activate has been called first.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p>To create <code class="docutils literal notranslate"><span class="pre">.ps1</span></code> files required for Powershell it is necessary to set to True the following conf: <code class="docutils literal notranslate"><span class="pre">tools.env.virtualenv:powershell</span></code>.</p>
</div>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="conan.tools.env.virtualbuildenv.VirtualBuildEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">VirtualBuildEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conanfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_generate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#conan.tools.env.virtualbuildenv.VirtualBuildEnv" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the environment variables of the build time context and produces a conanbuildenv
.bat or .sh script</p>
<dl class="py method">
<dt class="sig sig-object py" id="conan.tools.env.virtualbuildenv.VirtualBuildEnv.environment">
<span class="sig-name descname"><span class="pre">environment</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#conan.tools.env.virtualbuildenv.VirtualBuildEnv.environment" title="Link to this definition">¶</a></dt>
<dd><p>Returns an <code class="docutils literal notranslate"><span class="pre">Environment</span></code> object containing the environment variables of the build context.</p>
<dl class="field-list simple">
<dt class="field-odd">回傳<span class="colon">:</span></dt>
<dd class="field-odd"><p>an <code class="docutils literal notranslate"><span class="pre">Environment</span></code> object instance containing the obtained variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="conan.tools.env.virtualbuildenv.VirtualBuildEnv.vars">
<span class="sig-name descname"><span class="pre">vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'build'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#conan.tools.env.virtualbuildenv.VirtualBuildEnv.vars" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">參數<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scope</strong> – Scope to be used.</p>
</dd>
<dt class="field-even">回傳<span class="colon">:</span></dt>
<dd class="field-even"><p>An <code class="docutils literal notranslate"><span class="pre">EnvVars</span></code> instance containing the computed environment variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="conan.tools.env.virtualbuildenv.VirtualBuildEnv.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'build'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#conan.tools.env.virtualbuildenv.VirtualBuildEnv.generate" title="Link to this definition">¶</a></dt>
<dd><p>Produces the launcher scripts activating the variables for the build context.</p>
<dl class="field-list simple">
<dt class="field-odd">參數<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scope</strong> – Scope to be used.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="envvars.html" class="btn btn-neutral float-left" title="EnvVars" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="virtualrunenv.html" class="btn btn-neutral float-right" title="VirtualRunEnv" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">最後更新於 2月 17, 2026。
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>