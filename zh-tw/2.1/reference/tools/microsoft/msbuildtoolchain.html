<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MSBuildToolchain &mdash; conan 2.1.0 說明文件</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/reference/tools/microsoft/msbuildtoolchain.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5e00ceb5"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/translations.js?v=d9a6981e"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜尋" href="../../../search.html" />
    <link rel="next" title="VCVars" href="vcvars.html" />
    <link rel="prev" title="MSBuildDeps" href="msbuilddeps.html" />


 



</script>
<script type="text/javascript" src="../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">簡介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whatsnew.html">What’s new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">教學</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devops.html">開發運維指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">範例</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../reference.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../commands.html">Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile.html">conanfile.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile_txt.html">conanfile.txt</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tools.html">Recipe tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../android.html">conan.tools.android</a></li>
<li class="toctree-l3"><a class="reference internal" href="../apple.html">conan.tools.apple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build.html">conan.tools.build</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cmake.html">conan.tools.cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpp_info.html">conan.tools.CppInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../env.html">conan.tools.env</a></li>
<li class="toctree-l3"><a class="reference internal" href="../files.html">conan.tools.files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gnu.html">conan.tools.gnu</a></li>
<li class="toctree-l3"><a class="reference internal" href="../google.html">conan.tools.google</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intel.html">conan.tools.intel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../layout.html">conan.tools.layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../meson.html">conan.tools.meson</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../microsoft.html">conan.tools.microsoft</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="msbuild.html">MSBuild</a></li>
<li class="toctree-l4"><a class="reference internal" href="msbuilddeps.html">MSBuildDeps</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">MSBuildToolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="vcvars.html">VCVars</a></li>
<li class="toctree-l4"><a class="reference internal" href="nmake.html">NMakeDeps</a></li>
<li class="toctree-l4"><a class="reference internal" href="nmake.html#nmaketoolchain">NMakeToolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="visual_layout.html">vs_layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="helpers.html">conan.tools.microsoft.visual</a></li>
<li class="toctree-l4"><a class="reference internal" href="helpers.html#conan-tools-microsoft-subsystems">conan.tools.microsoft.subsystems</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../scm.html">conan.tools.scm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scons.html">conan.tools.scons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../system.html">conan.tools.system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../config_files.html">Configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions.html">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../environment.html">環境變數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../binary_model.html">二進位模型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conan_server.html">Conan Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">變更日誌</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../reference.html">Reference</a></li>
          <li class="breadcrumb-item"><a href="../../tools.html">Recipe tools</a></li>
          <li class="breadcrumb-item"><a href="../microsoft.html">conan.tools.microsoft</a></li>
      <li class="breadcrumb-item active">MSBuildToolchain</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/develop2/reference/tools/microsoft/msbuildtoolchain.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="msbuildtoolchain">
<span id="conan-tools-microsoft-msbuildtoolchain"></span><h1>MSBuildToolchain<a class="headerlink" href="#msbuildtoolchain" title="Link to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">MSBuildToolchain</span></code> is the toolchain generator for MSBuild. It will generate MSBuild properties files
that can be added to the Visual Studio solution projects. This generator translates the current package configuration,
settings, and options, into MSBuild properties files syntax.</p>
<p>This generator can be used by name in conanfiles:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><strong>conanfile.py</strong></span><a class="headerlink" href="#id1" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Pkg</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;MSBuildToolchain&quot;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><strong>conanfile.txt</strong></span><a class="headerlink" href="#id2" title="Link to this code">¶</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[generators]
MSBuildToolchain
</pre></div>
</div>
</div>
<p>And it can also be fully instantiated in the conanfile <code class="docutils literal notranslate"><span class="pre">generate()</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">conan</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">conan.tools.microsoft</span><span class="w"> </span><span class="kn">import</span> <span class="n">MSBuildToolchain</span>

<span class="k">class</span><span class="w"> </span><span class="nc">App</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tc</span> <span class="o">=</span> <span class="n">MSBuildToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tc</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MSBuildToolchain</span></code> will generate three files after a <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>.<span class="w"> </span><span class="c1"># default is Release</span>
$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>.<span class="w"> </span>-s<span class="w"> </span><span class="nv">build_type</span><span class="o">=</span>Debug
</pre></div>
</div>
<ul class="simple">
<li><p>The main <em>conantoolchain.props</em> file, to be added to the project.</p></li>
<li><p>A <em>conantoolchain_&lt;config&gt;.props</em> file, that will be conditionally included from the previous
<em>conantoolchain.props</em> file based on the configuration and platform, e.g., <em>conantoolchain_release_x86.props</em>.</p></li>
<li><p>A <em>conanvcvars.bat</em> file with the <code class="docutils literal notranslate"><span class="pre">vcvars</span></code> invocation to define the build environment from the command line,
or any other automated tools (might not be required if opening the IDE). This file will be automatically called
by the <code class="docutils literal notranslate"><span class="pre">MSBuild.build()</span></code> method.</p></li>
</ul>
<p>Every invocation with different configuration creates a new properties <code class="docutils literal notranslate"><span class="pre">.props</span></code> file, that is also conditionally
included. That allows to install different configurations, then switch among them directly from the Visual Studio IDE.</p>
<p>The MSBuildToolchain files can configure:</p>
<ul class="simple">
<li><p>The Visual Studio runtime (<em>MT/MD/MTd/MDd</em>), obtained from Conan input settings.</p></li>
<li><p>The C++ standard, obtained from Conan input settings.</p></li>
</ul>
<p>One of the advantages of using toolchains is that they help to achieve the exact same build with local development flows,
than when the package is created in the cache.</p>
<section id="customization">
<h2>Customization<a class="headerlink" href="#customization" title="Link to this heading">¶</a></h2>
<section id="conf">
<h3>conf<a class="headerlink" href="#conf" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">MSBuildToolchain</span></code> is affected by these <code class="docutils literal notranslate"><span class="pre">[conf]</span></code> variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tools.microsoft.msbuildtoolchain:compile_options</span></code> dict-like object of extra compile options to be added to <code class="docutils literal notranslate"><span class="pre">&lt;ClCompile&gt;</span></code> section.
The dict will be translated as follows: <code class="docutils literal notranslate"><span class="pre">&lt;[KEY]&gt;[VALUE]&lt;/[KEY]&gt;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tools.microsoft:winsdk_version</span></code> value will define the <code class="docutils literal notranslate"><span class="pre">&lt;WindowsTargetPlatformVersion&gt;</span></code> element in the toolchain file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tools.build:cxxflags</span></code> list of extra C++ flags that will be appended to <code class="docutils literal notranslate"><span class="pre">&lt;AdditionalOptions&gt;</span></code> section from <code class="docutils literal notranslate"><span class="pre">&lt;ClCompile&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;ResourceCompile&gt;</span></code> one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tools.build:cflags</span></code> list of extra of pure C flags that will be appended to <code class="docutils literal notranslate"><span class="pre">&lt;AdditionalOptions&gt;</span></code> section from <code class="docutils literal notranslate"><span class="pre">&lt;ClCompile&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;ResourceCompile&gt;</span></code> one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tools.build:sharedlinkflags</span></code> list of extra linker flags that will be appended to <code class="docutils literal notranslate"><span class="pre">&lt;AdditionalOptions&gt;</span></code> section from <code class="docutils literal notranslate"><span class="pre">&lt;Link&gt;</span></code> one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tools.build:exelinkflags</span></code> list of extra linker flags that will be appended to <code class="docutils literal notranslate"><span class="pre">&lt;AdditionalOptions&gt;</span></code> section from <code class="docutils literal notranslate"><span class="pre">&lt;Link&gt;</span></code> one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tools.build:defines</span></code> list of preprocessor definitions that will be appended to <code class="docutils literal notranslate"><span class="pre">&lt;PreprocessorDefinitions&gt;</span></code> section from <code class="docutils literal notranslate"><span class="pre">&lt;ResourceCompile&gt;</span></code> one.</p></li>
</ul>
</section>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="conan.tools.microsoft.MSBuildToolchain">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MSBuildToolchain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conanfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#conan.tools.microsoft.MSBuildToolchain" title="Link to this definition">¶</a></dt>
<dd><p>MSBuildToolchain class generator</p>
<dl class="field-list simple">
<dt class="field-odd">參數<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conanfile</strong> – <code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">ConanFile</span> <span class="pre">object</span> <span class="pre">&gt;</span></code> The current recipe object. Always use <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="conan.tools.microsoft.MSBuildToolchain.generate">
<span class="sig-name descname"><span class="pre">generate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#conan.tools.microsoft.MSBuildToolchain.generate" title="Link to this definition">¶</a></dt>
<dd><p>Generates a <code class="docutils literal notranslate"><span class="pre">conantoolchain.props</span></code>, a <code class="docutils literal notranslate"><span class="pre">conantoolchain_&lt;config&gt;.props</span></code>, and,
if <code class="docutils literal notranslate"><span class="pre">compiler=msvc</span></code>, a <code class="docutils literal notranslate"><span class="pre">conanvcvars.bat</span></code> files. In the first two cases, they’ll have the
valid XML format with all the good settings like any other VS project <code class="docutils literal notranslate"><span class="pre">*.props</span></code> file. The
last one emulates the <code class="docutils literal notranslate"><span class="pre">vcvarsall.bat</span></code> env script. See also <a class="reference internal" href="vcvars.html#conan.tools.microsoft.VCVars" title="conan.tools.microsoft.VCVars"><code class="xref py py-class docutils literal notranslate"><span class="pre">VCVars</span></code></a>.</p>
</dd></dl>

</dd></dl>

<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>properties</strong>: Additional properties added to the generated <code class="docutils literal notranslate"><span class="pre">.props</span></code> files. You can
define the properties in a key-value syntax like:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">conan</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConanFile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">conan.tools.microsoft</span><span class="w"> </span><span class="kn">import</span> <span class="n">MSBuildToolchain</span>

<span class="k">class</span><span class="w"> </span><span class="nc">App</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">msbuild</span> <span class="o">=</span> <span class="n">MSBuildToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">msbuild</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;IncludeExternals&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>
        <span class="n">msbuild</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
<p>Then, the generated <em>conantoolchain_&lt;config&gt;.props</em> file will contain the defined property
in its contents:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;Project</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://schemas.microsoft.com/developer/msbuild/2003&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;ItemDefinitionGroup&gt;</span>
...
<span class="nt">&lt;/ItemDefinitionGroup&gt;</span>
<span class="nt">&lt;PropertyGroup</span><span class="w"> </span><span class="na">Label=</span><span class="s">&quot;Configuration&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>...
<span class="hll"><span class="w">    </span><span class="nt">&lt;IncludeExternals&gt;</span>true<span class="nt">&lt;/IncludeExternals&gt;</span>
</span><span class="w">    </span>...
<span class="nt">&lt;/PropertyGroup&gt;</span>
<span class="nt">&lt;/Project&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="msbuilddeps.html" class="btn btn-neutral float-left" title="MSBuildDeps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vcvars.html" class="btn btn-neutral float-right" title="VCVars" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">最後更新於 10月 28, 2025。
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>