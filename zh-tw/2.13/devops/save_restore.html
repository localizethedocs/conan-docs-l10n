<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Save and restore packages from/to the cache &mdash; conan 2.13.0 說明文件</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/devops/save_restore.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=c2de7da6"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=d9a6981e"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="next" title="Vendoring dependencies in Conan packages" href="vendoring.html" />
    <link rel="prev" title="Handling version ranges and pre-releases" href="versioning/resolve_prereleases.html" />


 



</script>
<script type="text/javascript" src="../ltd-provenance.js"></script>
<script type="text/javascript" src="../ltd-current.js"></script>
<script type="text/javascript" src="../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.13
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">簡介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What’s new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">教學</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci_tutorial/tutorial.html">CI 教學</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="devops.html">開發運維指南</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="using_conancenter.html">Using ConanCenter packages in production environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="devops_local_recipes_index.html">Local Recipes Index Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="backup_sources/sources_backup.html">Backing up third-party sources with Conan</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadata.html">Managing package metadata files</a></li>
<li class="toctree-l2"><a class="reference internal" href="versioning/versioning.html">Versioning</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Save and restore packages from/to the cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="vendoring.html">Vendoring dependencies in Conan packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_promotions.html">Package promotions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">範例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../incubating.html">孵化中的功能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">變更日誌</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="devops.html">開發運維指南</a></li>
      <li class="breadcrumb-item active">Save and restore packages from/to the cache</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/develop2/devops/save_restore.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="save-and-restore-packages-from-to-the-cache">
<span id="devops-save-restore"></span><h1>Save and restore packages from/to the cache<a class="headerlink" href="#save-and-restore-packages-from-to-the-cache" title="Link to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>This feature is experimental and subject to breaking changes.
See <a class="reference internal" href="../introduction.html#stability"><span class="std std-ref">the Conan stability</span></a> section for more information.</p>
</div>
<p>With the <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">cache</span> <span class="pre">save</span></code> and <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">cache</span> <span class="pre">restore</span></code> commands, it is possible to create a .tgz from one or several packages from a Conan cache and later restore those packages into another Conan cache. There are some scenarios this can be useful:</p>
<ul class="simple">
<li><p>In Continuous Integration, specially if doing distributed builds, it might be very convenient to be able to move temporary packages recently built. Most CI systems have the capability of transferring files between jobs for this purpose. The Conan cache is not concurrent, sometimes for paralllel jobs different caches have to be used.</p></li>
<li><p>For air-gapped setups, in which packages can only be transferred via client side.</p></li>
<li><p>Developers directly sharing some packages with other developers for testing or inspection.</p></li>
</ul>
<p>The process of saving the packages is using the <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">cache</span> <span class="pre">save</span></code> command.
It can use a pattern, like the <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">list</span></code> command, but it can also accept a package-list, like other commands like <code class="docutils literal notranslate"><span class="pre">remove,</span> <span class="pre">upload,</span> <span class="pre">download</span></code>. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>cache<span class="w"> </span>save<span class="w"> </span><span class="s2">&quot;pkg/*:*&quot;</span>
Saving<span class="w"> </span>pkg/1.0:<span class="w"> </span>p/pkg1df6df1a3b33c
Saving<span class="w"> </span>pkg/1.0:9a4eb3c8701508aa9458b1a73d0633783ecc2270:<span class="w"> </span>p/b/pkgd573962ec2c90/p
Saving<span class="w"> </span>pkg/1.0:9a4eb3c8701508aa9458b1a73d0633783ecc2270<span class="w"> </span>metadata:<span class="w"> </span>p/b/pkgd573962ec2c90/p
...
<span class="c1"># creates conan_cache_save.tgz</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">conan_cache_save.tgz</span></code> file contains the packages named <code class="docutils literal notranslate"><span class="pre">pkg</span></code> (any version), the last recipe revision, and the last package revision of all the package binaries.
The name of the file can be changed with the optional <code class="docutils literal notranslate"><span class="pre">--file=xxxx</span></code> argument. Some important considerations:</p>
<ul class="simple">
<li><p>The command saves the contents of the cache 「recipe」 folders, containing the subfolders 「export」, 「export_sources」, 「download」, 「source」 and recipe 「metadata」.</p></li>
<li><p>The command saves the contents of the 「package」 and the package 「metadata」 folders, but not the binary 「build」 or 「download」, that are considered temporary folders.</p></li>
<li><p>If the user doesn’t want any of those folders to be saved, they can be cleaned before saving them with <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">cache</span> <span class="pre">clean</span></code> command</p></li>
<li><p>The command saves the cache files and artifacts as well as the metadata (revisions, package_id) to be able to restore those packages in another cache. But it doesn’t save any other cache state like <code class="docutils literal notranslate"><span class="pre">settings.yml</span></code>, <code class="docutils literal notranslate"><span class="pre">global.conf</span></code>, <code class="docutils literal notranslate"><span class="pre">remotes</span></code>, etc. If the saved packages require any other specific configuration, it should be managed with <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">config</span> <span class="pre">install</span></code>.</p></li>
</ul>
<p>We can move this <code class="docutils literal notranslate"><span class="pre">conan_cache_save.tgz</span></code> file to another Conan cache and restore it as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>cache<span class="w"> </span>restore<span class="w"> </span>conan_cache_save.tgz
Restore:<span class="w"> </span>pkg/1.0<span class="w"> </span><span class="k">in</span><span class="w"> </span>p/pkg1df6df1a3b33c
Restore:<span class="w"> </span>pkg/1.0:9a4eb3c8701508aa9458b1a73d0633783ecc2270<span class="w"> </span><span class="k">in</span><span class="w"> </span>p/b/pkg773791b8c97aa/p
Restore:<span class="w"> </span>pkg/1.0:9a4eb3c8701508aa9458b1a73d0633783ecc2270<span class="w"> </span>metadata<span class="w"> </span><span class="k">in</span><span class="w"> </span>p/b/pkg773791b8c97aa/d/metadata
...
</pre></div>
</div>
<p>The restore process will overwrite existing packages if they already exist in the cache.</p>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p><strong>最佳實踐</strong></p>
<ul class="simple">
<li><p>Saving and restoring packages is not a substitute for proper storage (upload) of packages in a Conan server repository.
It is only intended as a transitory mechanism, in CI systems, to save an air-gap, etc., but not as a long-term storage
and retrieval.</p></li>
<li><p>Saving and restoring packages is not a substitute for proper backup of server repositories. The recommended way to
implement long term backup of Conan packages is using some server side backup strategy.</p></li>
<li><p>The storage format and serialization is not guaranteed at this moment to be future-proof and stable. It is expected
to work in the same Conan version, but future Conan versions might break the storage format created with previous versions.
(this is aligned with the above recommendation to not use it as a backup strategy)</p></li>
</ul>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="versioning/resolve_prereleases.html" class="btn btn-neutral float-left" title="Handling version ranges and pre-releases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vendoring.html" class="btn btn-neutral float-right" title="Vendoring dependencies in Conan packages" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">最後更新於 10月 28, 2025。
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>