<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Building for multiple configurations: Release, Debug, Static and Shared &mdash; conan 2.17.1 說明文件</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/tutorial/consuming_packages/different_configurations.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=c0811917"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/translations.js?v=d9a6981e"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜尋" href="../../search.html" />
    <link rel="next" title="Understanding the flexibility of using conanfile.py vs conanfile.txt" href="the_flexibility_of_conanfile_py.html" />
    <link rel="prev" title="Using build tools as Conan packages" href="use_tools_as_conan_packages.html" />


 



</script>
<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.17
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">簡介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whatsnew.html">What’s new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Install</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorial.html">教學</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../consuming_packages.html">Consuming packages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="build_simple_cmake_project.html">Build a simple CMake project using Conan</a></li>
<li class="toctree-l3"><a class="reference internal" href="use_tools_as_conan_packages.html">Using build tools as Conan packages</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Building for multiple configurations: Release, Debug, Static and Shared</a></li>
<li class="toctree-l3"><a class="reference internal" href="the_flexibility_of_conanfile_py.html">Understanding the flexibility of using conanfile.py vs conanfile.txt</a></li>
<li class="toctree-l3"><a class="reference internal" href="cross_building_with_conan.html">How to cross-compile your applications using Conan: host and build contexts</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_to_versioning.html">Introduction to versioning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../creating_packages.html">Creating packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../conan_repositories.html">Working with Conan repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developing_packages.html">Developing packages locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="../versioning.html">Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other_features.html">Other important Conan features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ci_tutorial/tutorial.html">CI 教學</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/devops.html">開發運維指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/security.html">安全性</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">範例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../incubating.html">孵化中的功能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">變更日誌</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../tutorial.html">教學</a></li>
          <li class="breadcrumb-item"><a href="../consuming_packages.html">Consuming packages</a></li>
      <li class="breadcrumb-item active">Building for multiple configurations: Release, Debug, Static and Shared</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/develop2/tutorial/consuming_packages/different_configurations.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="building-for-multiple-configurations-release-debug-static-and-shared">
<span id="consuming-packages-different-configurations"></span><h1>Building for multiple configurations: Release, Debug, Static and Shared<a class="headerlink" href="#building-for-multiple-configurations-release-debug-static-and-shared" title="Link to this heading">¶</a></h1>
<p>Please, first clone the sources to recreate this project. You can find them in the
<a class="reference external" href="https://github.com/conan-io/examples2">examples2 repository</a> in GitHub:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/conan-io/examples2.git
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>examples2/tutorial/consuming_packages/different_configurations
</pre></div>
</div>
<p>So far, we built a simple CMake project that depended on the <strong>zlib</strong> library and learned
about <code class="docutils literal notranslate"><span class="pre">tool_requires</span></code>, a special type of <code class="docutils literal notranslate"><span class="pre">requirements</span></code> for build-tools like CMake. In
both cases, we did not specify anywhere that we wanted to build the application in
<em>Release</em> or <em>Debug</em> mode, or if we wanted to link against <em>static</em> or <em>shared</em> libraries.
That is because Conan, if not instructed otherwise, will use a default configuration
declared in the 『default profile』. This default profile was created in the first example
when we run the <strong class="command">conan profile detect</strong> command. Conan stores this file in the
<strong>/profiles</strong> folder, located in the Conan user home. You can check the contents of your
default profile by running the <strong class="command">conan config home</strong> command to get the location of the
Conan user home and then showing the contents of the default profile in the <strong>/profiles</strong>
folder:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>config<span class="w"> </span>home
Current<span class="w"> </span>Conan<span class="w"> </span>home:<span class="w"> </span>/Users/tutorial_user/.conan2

<span class="c1"># output the file contents</span>
$<span class="w"> </span>cat<span class="w"> </span>/Users/tutorial_user/.conan2/profiles/default
<span class="o">[</span>settings<span class="o">]</span>
<span class="nv">os</span><span class="o">=</span>Macos
<span class="nv">arch</span><span class="o">=</span>x86_64
<span class="nv">compiler</span><span class="o">=</span>apple-clang
compiler.version<span class="o">=</span><span class="m">14</span>.0
compiler.libcxx<span class="o">=</span>libc++
compiler.cppstd<span class="o">=</span>gnu11
<span class="nv">build_type</span><span class="o">=</span>Release
<span class="o">[</span>options<span class="o">]</span>
<span class="o">[</span>tool_requires<span class="o">]</span>
<span class="o">[</span>env<span class="o">]</span>

<span class="c1"># The default profile can also be checked with the command &quot;conan profile show&quot;</span>
</pre></div>
</div>
<p>As you can see, the profile has different sections. The <code class="docutils literal notranslate"><span class="pre">[settings]</span></code> section is the one
that has information about things like the operating system, architecture, compiler, and
build configuration.</p>
<p>When you call a Conan command setting the <code class="docutils literal notranslate"><span class="pre">--profile</span></code> argument,
Conan will take all the information from the profile and apply it to the packages you want
to build or install. If you don’t specify that argument it’s equivalent to call it with
<code class="docutils literal notranslate"><span class="pre">--profile=default</span></code>. These two commands will behave the same:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>.<span class="w"> </span>--build<span class="o">=</span>missing
$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>.<span class="w"> </span>--build<span class="o">=</span>missing<span class="w"> </span>--profile<span class="o">=</span>default
</pre></div>
</div>
<p>You can store different profiles and use them to build for different settings. For example,
to use a <code class="docutils literal notranslate"><span class="pre">build_type=Debug</span></code>, or adding a <code class="docutils literal notranslate"><span class="pre">tool_requires</span></code> to all the packages you build
with that profile. We will create a <em>debug</em> profile to try building with different configurations:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">&lt;conan home&gt;/profiles/debug</span><a class="headerlink" href="#id1" title="Link to this code">¶</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[settings]
os=Macos
arch=x86_64
compiler=apple-clang
compiler.version=14.0
compiler.libcxx=libc++
compiler.cppstd=gnu11
<span class="hll">build_type=Debug
</span></pre></div>
</div>
</div>
<section id="modifying-settings-use-debug-configuration-for-the-application-and-its-dependencies">
<span id="different-configurations-modify-settings"></span><h2>Modifying settings: use Debug configuration for the application and its dependencies<a class="headerlink" href="#modifying-settings-use-debug-configuration-for-the-application-and-its-dependencies" title="Link to this heading">¶</a></h2>
<p>Using profiles is not the only way to set the configuration you want to use. You can also
override the profile settings in the Conan command using the <code class="docutils literal notranslate"><span class="pre">--settings</span></code> argument. For
example, you can build the project from the previous examples in <em>Debug</em> configuration
instead of <em>Release</em>.</p>
<p>Before building, please check that we modified the source code from the previous example to show the build configuration the
sources were built with:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="p">...</span>

<span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span>
<span class="hll"><span class="w">    </span><span class="cp">#ifdef NDEBUG</span>
</span><span class="hll"><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Release configuration!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="hll"><span class="w">    </span><span class="cp">#else</span>
</span><span class="hll"><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Debug configuration!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class="hll"><span class="w">    </span><span class="cp">#endif</span>
</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now let’s build our project for <em>Debug</em> configuration:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>.<span class="w"> </span>--output-folder<span class="o">=</span>build<span class="w"> </span>--build<span class="o">=</span>missing<span class="w"> </span>--settings<span class="o">=</span><span class="nv">build_type</span><span class="o">=</span>Debug
</pre></div>
</div>
<p>As we explained above, this is the equivalent of having <em>debug</em> profile and running these
command using the <code class="docutils literal notranslate"><span class="pre">--profile=debug</span></code> argument instead of the
<code class="docutils literal notranslate"><span class="pre">--settings=build_type=Debug</span></code> argument.</p>
<p>This <strong class="command">conan install</strong> command will check if we already have the required libraries in the local cache
(Zlib) for Debug configuration and obtain them if not. It will also update the build
configuration in the <code class="docutils literal notranslate"><span class="pre">conan_toolchain.cmake</span></code> and <code class="docutils literal notranslate"><span class="pre">CMakePresets.json</span></code> files that the <code class="docutils literal notranslate"><span class="pre">CMakeToolchain</span></code> generator
creates so that when we build the application it’s built in <em>Debug</em> configuration. Now
build your project as you did in the previous examples and check in the output how it was
built in <em>Debug</em> configuration:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Windows</span><a class="headerlink" href="#id2" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># assuming Visual Studio 15 2017 is your VS version and that it matches your default profile</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
$<span class="w"> </span>cmake<span class="w"> </span>..<span class="w"> </span>-G<span class="w"> </span><span class="s2">&quot;Visual Studio 15 2017&quot;</span><span class="w"> </span>-DCMAKE_TOOLCHAIN_FILE<span class="o">=</span>conan_toolchain.cmake
$<span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--config<span class="w"> </span>Debug
$<span class="w"> </span>Debug<span class="se">\c</span>ompressor.exe
Uncompressed<span class="w"> </span>size<span class="w"> </span>is:<span class="w"> </span><span class="m">233</span>
Compressed<span class="w"> </span>size<span class="w"> </span>is:<span class="w"> </span><span class="m">147</span>
ZLIB<span class="w"> </span>VERSION:<span class="w"> </span><span class="m">1</span>.2.11
<span class="hll">Debug<span class="w"> </span>configuration!
</span></pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Linux, macOS</span><a class="headerlink" href="#id3" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
$<span class="w"> </span>cmake<span class="w"> </span>..<span class="w"> </span>-DCMAKE_TOOLCHAIN_FILE<span class="o">=</span>conan_toolchain.cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug
$<span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.
$<span class="w"> </span>./compressor
Uncompressed<span class="w"> </span>size<span class="w"> </span>is:<span class="w"> </span><span class="m">233</span>
Compressed<span class="w"> </span>size<span class="w"> </span>is:<span class="w"> </span><span class="m">147</span>
ZLIB<span class="w"> </span>VERSION:<span class="w"> </span><span class="m">1</span>.2.11
<span class="hll">Debug<span class="w"> </span>configuration!
</span></pre></div>
</div>
</div>
</section>
<section id="modifying-options-linking-the-application-dependencies-as-shared-libraries">
<span id="different-configurations-modify-options"></span><h2>Modifying options: linking the application dependencies as shared libraries<a class="headerlink" href="#modifying-options-linking-the-application-dependencies-as-shared-libraries" title="Link to this heading">¶</a></h2>
<p>So far, we have been linking <em>Zlib</em> statically in our application. That’s because in the
Zlib’s Conan package there’s an attribute set to build in that mode by default. We can
change from <strong>static</strong> to <strong>shared</strong> linking by setting the <code class="docutils literal notranslate"><span class="pre">shared</span></code> option to <code class="docutils literal notranslate"><span class="pre">True</span></code>
using the <code class="docutils literal notranslate"><span class="pre">--options</span></code> argument. To do so, please run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>install<span class="w"> </span>.<span class="w"> </span>--output-folder<span class="o">=</span>build<span class="w"> </span>--build<span class="o">=</span>missing<span class="w"> </span>--options<span class="o">=</span>zlib/1.2.11:shared<span class="o">=</span>True
</pre></div>
</div>
<p>Doing this, Conan will install the <em>Zlib</em> shared libraries, generate the files to build with
them and, also the necessary files to locate those dynamic libraries when running the
application.</p>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p>Options are defined per-package. In this case we were defining that we wanted that specific
version of zlib/1.2.11 as a shared library. If we had other dependencies and we want all of
our dependencies (whenever possible) as shared libraries, we would use <code class="docutils literal notranslate"><span class="pre">-o</span> <span class="pre">*:shared=True</span></code>,
with the <code class="docutils literal notranslate"><span class="pre">*</span></code> pattern that matches all package references.</p>
</div>
<p>Let’s build the application again after configuring it to link <em>Zlib</em> as a
shared library:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Windows</span><a class="headerlink" href="#id4" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
<span class="c1"># assuming Visual Studio 15 2017 is your VS version and that it matches your default profile</span>
$<span class="w"> </span>cmake<span class="w"> </span>..<span class="w"> </span>-G<span class="w"> </span><span class="s2">&quot;Visual Studio 15 2017&quot;</span><span class="w"> </span>-DCMAKE_TOOLCHAIN_FILE<span class="o">=</span>conan_toolchain.cmake
$<span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--config<span class="w"> </span>Release
...
<span class="o">[</span><span class="m">100</span>%<span class="o">]</span><span class="w"> </span>Built<span class="w"> </span>target<span class="w"> </span>compressor
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Linux, macOS</span><a class="headerlink" href="#id5" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
$<span class="w"> </span>cmake<span class="w"> </span>..<span class="w"> </span>-DCMAKE_TOOLCHAIN_FILE<span class="o">=</span>conan_toolchain.cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Release
$<span class="w"> </span>cmake<span class="w"> </span>--build<span class="w"> </span>.
...
<span class="o">[</span><span class="m">100</span>%<span class="o">]</span><span class="w"> </span>Built<span class="w"> </span>target<span class="w"> </span>compressor
</pre></div>
</div>
</div>
<p>Now, if you try to run the compiled executable you will see an error because the
executable can’t find the shared libraries for <em>Zlib</em> that we just installed.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Windows</span><a class="headerlink" href="#id6" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>Release<span class="se">\c</span>ompressor.exe
<span class="o">(</span>on<span class="w"> </span>a<span class="w"> </span>pop-up<span class="w"> </span>window<span class="o">)</span><span class="w"> </span>The<span class="w"> </span>code<span class="w"> </span>execution<span class="w"> </span>cannot<span class="w"> </span>proceed<span class="w"> </span>because<span class="w"> </span>zlib1.dll<span class="w"> </span>was<span class="w"> </span>not<span class="w"> </span>found.<span class="w"> </span>Reinstalling<span class="w"> </span>the<span class="w"> </span>program<span class="w"> </span>may<span class="w"> </span>fix<span class="w"> </span>this<span class="w"> </span>problem.
<span class="c1"># This error depends on the console being used and may not always pop up.</span>
<span class="c1"># It could run correctly if the console gets the zlib dll from a different path.</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Linux</span><a class="headerlink" href="#id7" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./compressor
./compressor:<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>loading<span class="w"> </span>shared<span class="w"> </span>libraries:<span class="w"> </span>libz.so.1:<span class="w"> </span>cannot<span class="w"> </span>open<span class="w"> </span>shared<span class="w"> </span>object<span class="w"> </span>file:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Macos</span><a class="headerlink" href="#id8" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./compressor
./compressor:<span class="w"> </span>dyld<span class="o">[</span><span class="m">41259</span><span class="o">]</span>:<span class="w"> </span>Library<span class="w"> </span>not<span class="w"> </span>loaded:<span class="w"> </span>@rpath/libz.1.dylib
</pre></div>
</div>
</div>
<p>This is because shared libraries (<em>.dll</em> in windows, <em>.dylib</em> in macOS and <em>.so</em> in Linux),
are loaded at runtime. That means that the application executable needs to know where
the required shared libraries are when it runs. On Windows, the dynamic linker will search in
the same directory, then in the <em>PATH</em> directories. On macOS, it will search in the
directories declared in <em>DYLD_LIBRARY_PATH</em>, and on Linux it will use <em>LD_LIBRARY_PATH</em>.</p>
<p>Conan provides a mechanism to define those variables and make it possible, for executables, to
find and load these shared libraries. This mechanism is the <code class="docutils literal notranslate"><span class="pre">VirtualRunEnv</span></code> generator.
If you check the output folder, you will see that Conan generated a new file called
<code class="docutils literal notranslate"><span class="pre">conanrun.sh/bat</span></code>. This is the result of automatically invoking that <code class="docutils literal notranslate"><span class="pre">VirtualRunEnv</span></code>
generator when we activated the <code class="docutils literal notranslate"><span class="pre">shared</span></code> option when doing the <strong class="command">conan install</strong>. This
generated script will set the <em>PATH</em>, <em>LD_LIBRARY_PATH</em>, <em>DYLD_LIBRARY_PATH</em> and
<em>DYLD_FRAMEWORK_PATH</em> environment variables so that executables can find the shared
libraries.</p>
<p>Activate the virtual environment, and run the executables again:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Windows</span><a class="headerlink" href="#id9" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conanrun.bat
$<span class="w"> </span>Release<span class="se">\c</span>ompressor.exe
Uncompressed<span class="w"> </span>size<span class="w"> </span>is:<span class="w"> </span><span class="m">233</span>
Compressed<span class="w"> </span>size<span class="w"> </span>is:<span class="w"> </span><span class="m">147</span>
...
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Linux, macOS</span><a class="headerlink" href="#id10" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>conanrun.sh
$<span class="w"> </span>./compressor
Uncompressed<span class="w"> </span>size<span class="w"> </span>is:<span class="w"> </span><span class="m">233</span>
Compressed<span class="w"> </span>size<span class="w"> </span>is:<span class="w"> </span><span class="m">147</span>
...
</pre></div>
</div>
</div>
<p>Just as in the previous example with the <code class="docutils literal notranslate"><span class="pre">VirtualBuildEnv</span></code> generator, when we run the
<code class="docutils literal notranslate"><span class="pre">conanrun.sh/bat</span></code> script, a deactivation script called <code class="docutils literal notranslate"><span class="pre">deactivate_conanrun.sh/bat</span></code> is
created to restore the environment. Source or run it to do so:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Windows</span><a class="headerlink" href="#id11" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>deactivate_conanrun.bat
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">Linux, macOS</span><a class="headerlink" href="#id12" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>deactivate_conanrun.sh
</pre></div>
</div>
</div>
</section>
<section id="difference-between-settings-and-options">
<span id="settings-and-options-difference"></span><h2>設定（settings）和選項（options）之間的區別<a class="headerlink" href="#difference-between-settings-and-options" title="Link to this heading">¶</a></h2>
<p>You may have noticed that for changing between <em>Debug</em> and <em>Release</em> configuration we
used a Conan <strong>setting</strong>, but when we set <em>shared</em> mode for our executable we used a
Conan <strong>option</strong>. Please note the difference between <strong>settings</strong> and <strong>options</strong>:</p>
<ul class="simple">
<li><p><strong>設定（settings）</strong>通常是由客戶端機器定義的專案級組態。例如作業系統、編譯器或建置組態等，這些將是多個 Conan 軟體包共有的，並且為其中一個設定定義預設值是沒有意義的。舉例來說，Conan 軟體包宣告「Visual Studio」作為預設編譯器是沒有意義的，因為這是由最終使用者定義的，如果他們在 Linux 環境下工作，這可能就沒有意義。</p></li>
<li><p><strong>options</strong> are intended for package-specific configuration that can be set to a default
value in the recipe. For example, one package can define that its default linkage is
static, and this is the linkage that should be used if consumers don’t specify
otherwise.</p></li>
</ul>
</section>
<section id="introducing-the-concept-of-package-id">
<h2>軟體包 ID 的概念簡介<a class="headerlink" href="#introducing-the-concept-of-package-id" title="Link to this heading">¶</a></h2>
<p>When consuming packages like Zlib with different <cite>settings</cite> and <cite>options</cite>, you might
wonder how Conan determines which binary to retrieve from the remote. The answer lies in
the concept of the <cite>package_id</cite>.</p>
<p>The <cite>package_id</cite> is an identifier that Conan uses to determine the binary compatibility of
packages. It is computed based on several factors, including the package’s <cite>settings</cite>,
<cite>options</cite>, and dependencies. When you modify any of these factors, Conan computes a new
<cite>package_id</cite> to reference the corresponding binary.</p>
<p>Here’s a breakdown of the process:</p>
<ol class="arabic simple">
<li><p><strong>確定設定和選項：</strong>Conan 首先會取得使用者的輸入設定和選項。這些可以來自命令行或設定檔，例如 <cite>–settings=build_type=Debug</cite> 或 <cite>–profile=debug</cite>。</p></li>
<li><p><strong>計算軟體包 ID：</strong>Conan 會根據 <cite>settings</cite>、<cite>options</cite> 和相依項的目前值計算一個雜湊值。該雜湊值即為 <cite>package_id</cite>，代表二進位軟體包的唯一識別。</p></li>
<li><p><strong>Fetch the Binary</strong>: Conan then checks its cache or the specified remote for a binary
package with the computed <cite>package_id</cite>. If it finds a match, it retrieves that binary.
If not, Conan can build the package from source or indicate that the binary is missing.</p></li>
</ol>
<p>在我們的教學中，當我們使用不同的 <cite>settings</cite> 和 <cite>options</cite> 來使用 Zlib 時，Conan 會使用 <cite>package_id</cite> 來確保它擷取了與我們指定組態相符的正確二進位軟體包。</p>
<div class="admonition seealso">
<p class="admonition-title">也參考</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../reference/tools/env/virtualrunenv.html#conan-tools-env-virtualrunenv"><span class="std std-ref">VirtualRunEnv reference</span></a></p></li>
<li><p><a class="reference internal" href="cross_building_with_conan.html#consuming-packages-cross-building-with-conan"><span class="std std-ref">Cross-compiling using –profile:build and –profile:host</span></a></p></li>
<li><p><a class="reference internal" href="../creating_packages/configure_options_settings.html#creating-packages-configure-options-settings"><span class="std std-ref">Conan packages binary compatibility: the package ID</span></a></p></li>
<li><p><a class="reference internal" href="../../reference/commands/config.html#reference-commands-conan-config-install"><span class="std std-ref">Installing configurations with conan config install</span></a></p></li>
<li><p>VS Multi-config</p></li>
<li><p><a class="reference internal" href="../../reference/binary_model/settings_and_options.html#reference-binary-model-settings-options"><span class="std std-ref">How settings and options influence the package id</span></a></p></li>
<li><p><a class="reference internal" href="../../reference/config_files/profiles.html#reference-config-files-profile-patterns"><span class="std std-ref">Using patterns for settings and options</span></a></p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="use_tools_as_conan_packages.html" class="btn btn-neutral float-left" title="Using build tools as Conan packages" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="the_flexibility_of_conanfile_py.html" class="btn btn-neutral float-right" title="Understanding the flexibility of using conanfile.py vs conanfile.txt" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">最後更新於 10月 28, 2025。
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>