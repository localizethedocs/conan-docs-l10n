<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Build a simple Autotools project with Conan dependencies &mdash; conan 2.22.2 說明文件</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/examples/tools/autotools/build_project_autotools_toolchain.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=48dfd85a"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/translations.js?v=d9a6981e"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜尋" href="../../../search.html" />
    <link rel="next" title="Create your first Conan package with Autotools" href="create_your_first_package.html" />
    <link rel="prev" title="Autotools" href="autotools.html" />


 



</script>
<script type="text/javascript" src="../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.22
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">介紹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">安裝</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">教學</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ci_tutorial/tutorial.html">CI 教學</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devops/devops.html">開發運維指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/security.html">安全性</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../integrations.html">Integrations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../examples.html">範例</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../conanfile.html">ConanFile 方法範例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions.html">Conan 擴充功能範例</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tools.html">Conan recipe tools examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../cmake/cmake.html">CMake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../files/files.html">File interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../meson/meson.html">Meson</a></li>
<li class="toctree-l3"><a class="reference internal" href="../google/bazel.html">Bazel</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="autotools.html">Autotools</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Build a simple Autotools project with Conan dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="create_your_first_package.html">Create your first Conan package with Autotools</a></li>
<li class="toctree-l4"><a class="reference internal" href="create_your_first_package_windows.html">Create your first Conan package with Autotools in Windows (msys2)</a></li>
<li class="toctree-l4"><a class="reference internal" href="llvm_clang.html">AutoTools: Using LLVM/Clang Windows compiler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../scm/git/capture_scm/git_capture_scm.html">Capturing Git scm information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../microsoft/msbuild.html">MSBuild</a></li>
<li class="toctree-l3"><a class="reference internal" href="../system/system.html">System Packages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cross_build.html">交叉建置範例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config_files.html">組態檔範例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../graph.html">Graph examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev_flow.html">開發者工具與流程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../commands.html">Conan 命令範例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../runners.html">Conan 執行器範例</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security.html">Conan security examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../incubating.html">孵化中的功能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whatsnew.html">What’s new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">變更日誌</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../examples.html">範例</a></li>
          <li class="breadcrumb-item"><a href="../../tools.html">Conan recipe tools examples</a></li>
          <li class="breadcrumb-item"><a href="autotools.html">Autotools</a></li>
      <li class="breadcrumb-item active">Build a simple Autotools project with Conan dependencies</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/develop2/examples/tools/autotools/build_project_autotools_toolchain.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="build-a-simple-autotools-project-with-conan-dependencies">
<span id="examples-tools-autotools-autotools-toolchain-build-project-autotools-toolchain"></span><h1>Build a simple Autotools project with Conan dependencies<a class="headerlink" href="#build-a-simple-autotools-project-with-conan-dependencies" title="Link to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>This example will only work for Linux and OSX environments and does not support Windows directly, including msys2/cygwin subsystems.
However, Windows Subsystem for Linux (WSL) should work since it provides a Linux environment. While Conan offers <cite>win_bash = True</cite>
for some level of support in Windows environments with Autotools, it’s not applicable in this tutorial.</p>
</div>
<p>In this example, we are going to create a string formatter application
that uses one of the most popular C++ libraries: <a class="reference external" href="https://fmt.dev/latest">fmt</a>.</p>
<p>We’ll use <a class="reference external" href="https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html">Autotools</a> as build system and <a class="reference external" href="https://www.freedesktop.org/wiki/Software/pkg-config/">pkg-config</a> as a helper tool in this case, so you should get them installed
on Linux and Mac before going forward with this example.</p>
<p>Please, first clone the sources to recreate this project. You can find them in the
<a class="reference external" href="https://github.com/conan-io/examples2">examples2 repository</a> on GitHub:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/conan-io/examples2.git
<span class="nb">cd</span><span class="w"> </span>examples2/examples/tools/autotools/autotoolstoolchain/string_formatter
</pre></div>
</div>
<p>We start with a very simple C++ language project with the following structure:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>.
├── configure.ac
├── Makefile.am
├── conanfile.txt
└── src
    └── main.cpp
</pre></div>
</div>
<p>This project contains a basic <cite>configure.ac &lt;https://www.gnu.org/software/autoconf/manual/autoconf-2.60/html_node/Writing-configure_002eac.html&gt;_</cite> including the <strong>fmt</strong> pkg-config dependency and the
source code for the string formatter program in <em>main.cpp</em>.</p>
<p>Let’s have a look at the <em>main.cpp</em> file, it only prints a simple message but uses <code class="docutils literal notranslate"><span class="pre">fmt::print</span></code> method for it.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><strong>main.cpp</strong></span><a class="headerlink" href="#id1" title="Link to this code">¶</a></div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdlib&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fmt/core.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fmt</span><span class="o">::</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;{} - The C++ Package Manager!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Conan&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">configure.ac</span></code> file checks for a C++ compiler using the <code class="docutils literal notranslate"><span class="pre">AC_PROG_CXX</span></code> macro and also checks for the <code class="docutils literal notranslate"><span class="pre">fmt.pc</span></code> pkg-config module using the <code class="docutils literal notranslate"><span class="pre">PKG_CHECK_MODULES</span></code> macro.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><strong>configure.ac</strong></span><a class="headerlink" href="#id2" title="Link to this code">¶</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>AC_INIT([stringformatter], [0.1.0])
AM_INIT_AUTOMAKE([1.10 -Wall no-define foreign])
AC_CONFIG_SRCDIR([src/main.cpp])
AC_CONFIG_FILES([Makefile])
PKG_CHECK_MODULES([fmt], [fmt])
AC_PROG_CXX
AC_OUTPUT
</pre></div>
</div>
</div>
<p>The <em>Makefile.am</em> specifies that <code class="docutils literal notranslate"><span class="pre">string_formatter</span></code> is the expected executable and that it should be linked to the <code class="docutils literal notranslate"><span class="pre">fmt</span></code> library.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><strong>Makefile.am</strong></span><a class="headerlink" href="#id3" title="Link to this code">¶</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>AUTOMAKE_OPTIONS = subdir-objects
ACLOCAL_AMFLAGS = ${ACLOCAL_FLAGS}

bin_PROGRAMS = string_formatter
string_formatter_SOURCES = src/main.cpp
string_formatter_CPPFLAGS = $(fmt_CFLAGS)
string_formatter_LDADD = $(fmt_LIBS)
</pre></div>
</div>
</div>
<p>The <em>conanfile.txt</em> looks simple as it just installs the <strong>fmt</strong> package and uses two generators to build our project.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><strong>conanfile.txt</strong></span><a class="headerlink" href="#id4" title="Link to this code">¶</a></div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[requires]</span>
<span class="na">fmt/9.1.0</span>

<span class="k">[generators]</span>
<span class="na">AutotoolsToolchain</span>
<span class="na">PkgConfigDeps</span>
</pre></div>
</div>
</div>
<p>In this case, we will use <a class="reference internal" href="../../../reference/tools/gnu/pkgconfigdeps.html#conan-tools-gnu-pkgconfigdeps"><span class="std std-ref">PkgConfigDeps</span></a> to generate information about where the <strong>fmt</strong> library
files are installed thanks to the <cite>*.pc</cite> files and <a class="reference internal" href="../../../reference/tools/gnu/autotoolstoolchain.html#conan-tools-gnu-autotoolstoolchain"><span class="std std-ref">AutotoolsToolchain</span></a> to pass build information
to <em>autotools</em> using a <cite>conanbuild[.sh|.bat]</cite> file that describes the compilation environment.</p>
<p>We will use Conan to install <strong>fmt</strong> library, generate a toolchain for Autotools, and, .pc files for find <strong>fmt</strong> by pkg-config.</p>
<section id="building-on-linux-and-macos">
<h2>在 Linux 和 macOS 上進行建置<a class="headerlink" href="#building-on-linux-and-macos" title="Link to this heading">¶</a></h2>
<p>First, we should install some requirements. On Linux you need to have <code class="docutils literal notranslate"><span class="pre">automake</span></code> , <code class="docutils literal notranslate"><span class="pre">pkgconf</span></code> and <code class="docutils literal notranslate"><span class="pre">make</span></code> packages installed,
their packages names should vary according to the Linux distribution, but essentially,
it should include all tools (aclocal, automake, autoconf and make) that you will need to build the following example.</p>
<p>For this example, we will not consider a specific Conan profile, but <code class="docutils literal notranslate"><span class="pre">fmt</span></code> is highly compatible with many different configurations.
So it should work mostly with versions of GCC and Clang compiler.</p>
<p>As the first step, we should install all dependencies listed in the <code class="docutils literal notranslate"><span class="pre">conanfile.txt</span></code>.
The command :ref: <cite>conan install&lt;reference_commands_install&gt;</cite> will not only install the <code class="docutils literal notranslate"><span class="pre">fmt</span></code> package,
but also build it from sources in case your profile does not match with a pre-built binary in your remotes.
Plus, it will provide these generators listed in the <code class="docutils literal notranslate"><span class="pre">conanfile.txt</span></code></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>conan<span class="w"> </span>install<span class="w"> </span>.<span class="w"> </span>--build<span class="o">=</span>missing
</pre></div>
</div>
<p>After running <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> command, we should have new files present in the <em>string_formatter</em> folder:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>└── string_formatter
    ├── Makefile.am
    ├── conanautotoolstoolchain.sh
    ├── conanbuild.conf
    ├── conanbuild.sh
    ├── conanbuildenv-release-armv8.sh
    ├── conanfile.txt
    ├── conanrun.sh
    ├── conanrunenv-release-armv8.sh
    ├── configure.ac
    ├── deactivate_conanbuild.sh
    ├── deactivate_conanrun.sh
    ├── fmt-_fmt.pc
    ├── fmt.pc
    ├── run_example.sh
    └── src
        └── main.cpp
</pre></div>
</div>
<p>These files are the result of those generators listed in the <code class="docutils literal notranslate"><span class="pre">conanfile.txt</span></code>.
Once all files needed to build the example are generated and <code class="docutils literal notranslate"><span class="pre">fmt</span></code> is installed, now we can load the script <code class="docutils literal notranslate"><span class="pre">conanbuild.sh</span></code>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span><span class="w"> </span>conanbuild.sh
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">conanbuild.sh</span></code> is a default file generated by the <a class="reference internal" href="../../../reference/tools/env/virtualbuildenv.html#conan-tools-env-virtualbuildenv"><span class="std std-ref">VirtualBuildEnv</span></a> and helps us to load other
script files, so we don’t need to execute more manual steps to load each generator file. It will load <code class="docutils literal notranslate"><span class="pre">conanautotoolstoolchain.sh</span></code>,
generated by <cite>AutotoolsToolchain</cite>, which defines environment variables according to our
Conan profile, used when running <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> command. Those environment variables configured are related to the compiler
and <code class="docutils literal notranslate"><span class="pre">autotools</span></code>, like <code class="docutils literal notranslate"><span class="pre">CFLAGS</span></code>, <code class="docutils literal notranslate"><span class="pre">CPPFLAGS</span></code>, <code class="docutils literal notranslate"><span class="pre">LDFLAGS</span></code>, and <code class="docutils literal notranslate"><span class="pre">PKG_CONFIG_PATH</span></code>.</p>
<p>As the next step, we can configure the project by running the following commands in sequence:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>aclocal
automake<span class="w"> </span>--add-missing
autoconf
./configure
</pre></div>
</div>
<p>The <a class="reference external" href="https://www.gnu.org/software/automake/manual/html_node/aclocal-Invocation.html">aclocal</a> command will read the file <code class="docutils literal notranslate"><span class="pre">configure.ac</span></code>
and generate a new file named <code class="docutils literal notranslate"><span class="pre">aclocal.m4</span></code>, which contains macros needed by the <code class="docutils literal notranslate"><span class="pre">automake</span></code>. As the second step,
the <a class="reference external" href="https://www.gnu.org/software/automake/manual/automake.html">automake</a> command will read the <code class="docutils literal notranslate"><span class="pre">Makefile.am</span></code>, and will generate the file <code class="docutils literal notranslate"><span class="pre">Makefile.in</span></code>.
So the command <a class="reference external" href="https://www.gnu.org/software/autoconf/">autoconf</a> will use those files and generate the <code class="docutils literal notranslate"><span class="pre">configure</span></code> file.
Once we run <code class="docutils literal notranslate"><span class="pre">configure</span></code>, all environment variables will be consumed. The <code class="docutils literal notranslate"><span class="pre">fmt.pc</span></code> will be loaded at this step too,
as <code class="docutils literal notranslate"><span class="pre">autotools</span></code> uses the custom <code class="docutils literal notranslate"><span class="pre">PKG_CONFIG_PATH</span></code> to find it.</p>
<p>Then, finally, we can build the project to generate the string formatter application.
Now we run the <code class="docutils literal notranslate"><span class="pre">make</span></code> command, which will consume the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> generated by <code class="docutils literal notranslate"><span class="pre">autotools</span></code>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>make
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">make</span></code> command will read the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> and invoke the compiler, then, build the <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code>, generating the executable <code class="docutils literal notranslate"><span class="pre">string_formatter</span></code> in the same folder.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>./string_formatter
Conan<span class="w"> </span>-<span class="w"> </span>The<span class="w"> </span>C++<span class="w"> </span>Package<span class="w"> </span>Manager!
</pre></div>
</div>
<p>The final output is the result of a new application, printing a message with the help of <code class="docutils literal notranslate"><span class="pre">fmt</span></code> library, and built by <code class="docutils literal notranslate"><span class="pre">Autotools</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="autotools.html" class="btn btn-neutral float-left" title="Autotools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="create_your_first_package.html" class="btn btn-neutral float-right" title="Create your first Conan package with Autotools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">最後更新於 2月 17, 2026。
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>