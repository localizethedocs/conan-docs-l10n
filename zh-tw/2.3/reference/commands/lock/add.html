<!DOCTYPE html>
<html class="writer-html5" lang="zh-TW" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>conan lock add &mdash; conan 2.3.2 說明文件</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=2da93098" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/conan.css?v=7d9e9f1e" />

  
    <link rel="shortcut icon" href="../../../_static/conan-favicon.png"/>
    <link rel="canonical" href="https://projects.localizethedocs.org/conan-docs-l10n/reference/commands/lock/add.html" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=9e7899f4"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/translations.js?v=d9a6981e"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜尋" href="../../../search.html" />
    <link rel="next" title="conan lock create" href="create.html" />
    <link rel="prev" title="conan lock" href="../lock.html" />


 



</script>
<script type="text/javascript" src="../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../ltd-flyout.js"></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/conan-docs-logo-2.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">簡介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../whatsnew.html">What’s new in Conan 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">教學</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devops.html">開發運維指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">範例</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../reference.html">Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../commands.html">Commands</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../cache.html">conan cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config.html">conan config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../graph.html">conan graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../inspect.html">conan inspect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html">conan install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../list.html">conan list</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../lock.html">conan lock</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">conan lock add</a></li>
<li class="toctree-l4"><a class="reference internal" href="create.html">conan lock create</a></li>
<li class="toctree-l4"><a class="reference internal" href="merge.html">conan lock merge</a></li>
<li class="toctree-l4"><a class="reference internal" href="remove.html">conan lock remove</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pkglist.html">conan pkglist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../profile.html">conan profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../remove.html">conan remove</a></li>
<li class="toctree-l3"><a class="reference internal" href="../remote.html">conan remote</a></li>
<li class="toctree-l3"><a class="reference internal" href="../search.html">conan search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../version.html">conan version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build.html">conan build</a></li>
<li class="toctree-l3"><a class="reference internal" href="../create.html">conan create</a></li>
<li class="toctree-l3"><a class="reference internal" href="../download.html">conan download</a></li>
<li class="toctree-l3"><a class="reference internal" href="../editable.html">conan editable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../export.html">conan export</a></li>
<li class="toctree-l3"><a class="reference internal" href="../export-pkg.html">conan export-pkg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../new.html">conan new</a></li>
<li class="toctree-l3"><a class="reference internal" href="../source.html">conan source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../test.html">conan test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upload.html">conan upload</a></li>
<li class="toctree-l3"><a class="reference internal" href="../formatters/graph_info_json_formatter.html">Formatter: Graph-info JSON</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile.html">conanfile.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conanfile_txt.html">conanfile.txt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools.html">Recipe tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config_files.html">Configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extensions.html">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../environment.html">環境變數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../binary_model.html">二進位模型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../conan_server.html">Conan Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../runners.html">Runners</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../knowledge.html">Knowledge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">變更日誌</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">conan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../reference.html">Reference</a></li>
          <li class="breadcrumb-item"><a href="../../commands.html">Commands</a></li>
          <li class="breadcrumb-item"><a href="../lock.html">conan lock</a></li>
      <li class="breadcrumb-item active">conan lock add</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/conan-io/docs/blob/develop2/reference/commands/lock/add.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="conan-lock-add">
<h1>conan lock add<a class="headerlink" href="#conan-lock-add" title="Link to this heading">¶</a></h1>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ conan lock add -h
usage: conan lock add [-h] [-v [V]] [-cc CORE_CONF] [--requires REQUIRES]
                      [--build-requires BUILD_REQUIRES]
                      [--python-requires PYTHON_REQUIRES]
                      [--config-requires CONFIG_REQUIRES]
                      [--lockfile-out LOCKFILE_OUT] [--lockfile LOCKFILE]

Add requires, build-requires or python-requires to an existing or new
lockfile. The resulting lockfile will be ordered, newer versions/revisions
first. References can be supplied with and without revisions like &quot;--
requires=pkg/version&quot;, but they must be package references, including at least
the version, and they cannot contain a version range.

options:
  -h, --help            show this help message and exit
  -v [V]                Level of detail of the output. Valid options from less
                        verbose to more verbose: -vquiet, -verror, -vwarning,
                        -vnotice, -vstatus, -v or -vverbose, -vv or -vdebug,
                        -vvv or -vtrace
  -cc CORE_CONF, --core-conf CORE_CONF
                        Global configuration for Conan
  --requires REQUIRES   Add references to lockfile.
  --build-requires BUILD_REQUIRES
                        Add build-requires to lockfile
  --python-requires PYTHON_REQUIRES
                        Add python-requires to lockfile
  --config-requires CONFIG_REQUIRES
                        Add config-requires to lockfile
  --lockfile-out LOCKFILE_OUT
                        Filename of the created lockfile
  --lockfile LOCKFILE   Filename of the input lockfile
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">lock</span> <span class="pre">add</span></code> command is able to add a package version to an existing or new lockfile <code class="docutils literal notranslate"><span class="pre">requires</span></code>, <code class="docutils literal notranslate"><span class="pre">build_requires</span></code> or <code class="docutils literal notranslate"><span class="pre">python_requires</span></code>.</p>
<p>For example, the following is able to create a lockfile (by default, named <code class="docutils literal notranslate"><span class="pre">conan.lock</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>lock<span class="w"> </span>add<span class="w"> </span>--requires<span class="o">=</span>pkg/1.1<span class="w"> </span>--build-requires<span class="o">=</span>tool/2.2<span class="w"> </span>--python-requires<span class="o">=</span>mypytool/3.3
Generated<span class="w"> </span>lockfile:<span class="w"> </span>...conan.lock

<span class="nv">$cat</span><span class="w"> </span>conan.lock
<span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;version&quot;</span>:<span class="w"> </span><span class="s2">&quot;0.5&quot;</span>,
<span class="w">    </span><span class="s2">&quot;requires&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span><span class="s2">&quot;pkg/1.1&quot;</span>
<span class="w">    </span><span class="o">]</span>,
<span class="w">    </span><span class="s2">&quot;build_requires&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span><span class="s2">&quot;tool/2.2&quot;</span>
<span class="w">    </span><span class="o">]</span>,
<span class="w">    </span><span class="s2">&quot;python_requires&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span><span class="s2">&quot;mypytool/3.3&quot;</span>
<span class="w">    </span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">lock</span> <span class="pre">add</span></code> command also allows to provide an existing lockfile as an input,
and it will add the arguments to the existing lockfile, maintaining the
package versions sorted:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>lock<span class="w"> </span>add<span class="w"> </span>--build-requires<span class="o">=</span>tool/2.3<span class="w"> </span>--lockfile<span class="o">=</span>conan.lock
Using<span class="w"> </span>lockfile:<span class="w"> </span><span class="s1">&#39;.../conan.lock&#39;</span>
Generated<span class="w"> </span>lockfile:<span class="w"> </span>.../conan.lock

$<span class="w"> </span>cat<span class="w"> </span>conan.lock
<span class="o">{</span>
<span class="w">    </span><span class="s2">&quot;version&quot;</span>:<span class="w"> </span><span class="s2">&quot;0.5&quot;</span>,
<span class="w">    </span><span class="s2">&quot;requires&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span><span class="s2">&quot;pkg/1.1&quot;</span>
<span class="w">    </span><span class="o">]</span>,
<span class="w">    </span><span class="s2">&quot;build_requires&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span><span class="s2">&quot;tool/2.3&quot;</span>,
<span class="w">        </span><span class="s2">&quot;tool/2.2&quot;</span>
<span class="w">    </span><span class="o">]</span>,
<span class="w">    </span><span class="s2">&quot;python_requires&quot;</span>:<span class="w"> </span><span class="o">[</span>
<span class="w">        </span><span class="s2">&quot;mypytool/3.3&quot;</span>
<span class="w">    </span><span class="o">]</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">lock</span> <span class="pre">add</span></code> command does not perform any checking on the lockfile, the packages, the existence of packages,
the existence of package versions, or the existence of those packages in a given dependency graph, it is a basic manipulation of the json information.
When that lockfile is applied to resolve a dependency graph, it is possible that the added versions do not exist,
or do not resolve for the <code class="docutils literal notranslate"><span class="pre">conanfile.py</span></code> recipes defined version ranges.</p>
<p>Moreover, the list of versions is still sorted. Adding an older version like <code class="docutils literal notranslate"><span class="pre">tool/2.1</span></code> to the previous lockfile
won’t make that version being used automatically if the recipes contain the version range <code class="docutils literal notranslate"><span class="pre">tool/[&gt;=2.0</span> <span class="pre">&lt;3]</span></code>, because
the <code class="docutils literal notranslate"><span class="pre">tool/2.2</span></code> version is listed there and the range will resolve to it, not to the older <code class="docutils literal notranslate"><span class="pre">tool/2.1</span></code>.</p>
<p>Note that a lockfile created with <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">lock</span> <span class="pre">add</span></code> can be incomplete and not contain all necessary locked versions
that a full dependency graph would need. For those cases, recall that the <code class="docutils literal notranslate"><span class="pre">--lockfile-partial</span></code> argument can be applied.
Note also that if a <code class="docutils literal notranslate"><span class="pre">conan.lock</span></code> file exist in the current folder, Conan commands like <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> will automatically use it.
Please have a look to the <a class="reference internal" href="../../../tutorial/versioning/lockfiles.html#tutorial-versioning-lockfiles"><span class="std std-ref">lockfiles tutorial</span></a>.</p>
<p>If explicitly adding revisions, please recall that the revisions are timestamp sorted. If more than one revision exists in the lockfile,
it is mandatory to provide the timestamps of those revisions, so the sorting makes sense, which can be done with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conan<span class="w"> </span>lock<span class="w"> </span>add<span class="w"> </span>--requires<span class="o">=</span>pkg/1.1#revision%timestamp
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<ul class="simple">
<li><p>It is forbidden to manually manipulate a Conan lockfile, changing the strict sorting of references, and that could result in
any arbitrary undefined behavior.</p></li>
<li><p>Recall that it is not possible to <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">lock</span> <span class="pre">add</span></code> a version range. The version might be not fully complete (like not providing
the revision), but it must be an exact version.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">備註</p>
<p><strong>最佳實踐</strong></p>
<p>This command will not be necessary in many situations. The existing <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code>, <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">create</span></code>, <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">lock</span></code>, <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">export</span></code>,
<code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">graph</span></code> commands can directly update or produce new lockfiles with the new information of the packages they are creating, and
those new or updated lockfiles can be used to continue with the processing.</p>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../lock.html" class="btn btn-neutral float-left" title="conan lock" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="create.html" class="btn btn-neutral float-right" title="conan lock create" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, JFrog.
      <span class="lastupdated">最後更新於 10月 28, 2025。
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>


 


</body>
</html>